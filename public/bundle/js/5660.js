/*! For license information please see 5660.js.LICENSE.txt */
"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[5660],{90457:(t,i,e)=>{e.r(i),e.d(i,{ResizeProperty:()=>h,default:()=>p});var s=e(64882),n=e(68920),a=e(80783),o=e(7478);class r extends o.QB{constructor(t,i){super(),this.x=t,this.y=i}}var h,c=e(52018),d=e(58095),g=e(10459),l=e(37105);class u extends c.t{}!function(t){t.left="left",t.top="top",t.width="width",t.height="height"}(h||(h={}));const f={[h.width]:"width",[h.height]:"height",[h.top]:"top",[h.left]:"left"};class p extends s.n{constructor(){super(...arguments),this.name="canvas",this.getNewX=()=>0,this.getNewY=()=>0,this.getNewWidth=t=>t.width,this.getNewHeight=t=>t.height,this.activeTransitions=[],this.activeTransitionMap={left:null,top:null,width:null,height:null},this.onResize=t=>{t.propertyName in h&&(this.resolveActiveTransition(t.propertyName),this._canvas.style.transitionDuration=this.stringifyTransitionDurations())},this.onContainerResize=()=>{this.transitionDurations.left=this.transitionDurations.top=this.transitionDurations.width=this.transitionDurations.height="0s",this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition(),this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),this._canvas.style.transitionDuration=this.stringifyTransitionDurations()}}async init(t,i){if(this.engine=i,!t.container)throw new u;this.container=t.container,this.container.appendChild(t.canvas),this.containerBounds=this.container.getBoundingClientRect(),this._canvas=t.canvas,this._canvas.style.position="absolute",this._canvas.style.left="0",this._canvas.style.top="0",this.transitionDurations={left:"0s",top:"0s",width:"0s",height:"0s",filter:"0.4s"},this._canvas.style.transitionProperty=Object.keys(this.transitionDurations).join(","),this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.updateTransitions(),this.bindings.push(i.subscribe(d.P,this.onContainerResize),this.makeTransitionEndSubscription());for(const t of this.bindings)t.renew();this.canvasBounds=this._canvas.getBoundingClientRect(),this.containerBounds=this.container.getBoundingClientRect(),this.data=new l.p(this.canvasBounds.width,this.canvasBounds.height,this._canvas),i.market.register(l.p,this.data)}async resizeCanvas(t){if(0===t.length)return[];const i=this.engine.market.tryGetData(g.M);return i&&!i.canTransition()&&await i.transition.promise,this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),t.forEach((t=>{const{property:i,setDimension:e,duration:s=0}=t,a=f[i],o=this._canvas.style[a];switch(i){case h.height:this.setHeight(e,s);break;case h.width:this.setWidth(e,s);break;case h.top:this.setY(e,s);break;case h.left:this.setX(e,s)}if(this._canvas.style[a]!==o&&s>0){const t=new n.i;t.then((()=>{clearTimeout(e)}));const e=setTimeout((()=>{this.resolveActiveTransition(i)}),s+500);this.activeTransitionMap[i]=t,this.activeTransitions.push(i)}})),this.hasActiveTransitions()||(this.canvasBounds=this._canvas.getBoundingClientRect()),this.getTransitionPromise()}makeTransitionEndSubscription(){let t=!1;return{renew:()=>{t||(this.element.addEventListener("transitionend",this.onResize),t=!0)},cancel:()=>{t&&(this.element.removeEventListener("transitionend",this.onResize),t=!1)}}}dispose(t){super.dispose(t)}get element(){return this._canvas}get width(){return this.canvasBounds.width}get height(){return this.canvasBounds.height}get x(){return this.canvasBounds.left}get y(){return this.canvasBounds.top}onUpdate(){const t=this.container.getBoundingClientRect(),i=this.containerHasChanged(t);i&&(this.containerBounds=t,this.updateTransitions()),(i||this.hasActiveTransitions())&&(this.canvasBounds=this._canvas.getBoundingClientRect());const e=this.data.width!==this.width||this.data.height!==this.height,s=this.data.x!==this.x||this.data.y!==this.y;e&&(this.data.width=this.width,this.data.height=this.height,this.data.commit(),this.engine.broadcast(new a.h(this.width,this.height))),s&&(this.data.x=this.x,this.data.y=this.y,this.data.commit(),this.engine.broadcast(new r(this.x-this.containerBounds.left,this.y-this.containerBounds.top)))}containerHasChanged(t){return t.left!==this.containerBounds.left||t.top!==this.containerBounds.top||t.width!==this.containerBounds.width||t.height!==this.containerBounds.height}setX(t,i=0){this.getNewX="number"==typeof t?()=>t:t,this.transitionDurations.left=`${i}ms`,this.updateTransitions()}setY(t,i=0){this.getNewY="number"==typeof t?()=>t:t,this.transitionDurations.top=`${i}ms`,this.updateTransitions()}setWidth(t,i=0){this.getNewWidth="number"==typeof t?()=>t:t,this.transitionDurations.width=`${i}ms`,this.updateTransitions()}setHeight(t,i=0){this.getNewHeight="number"==typeof t?()=>t:t,this.transitionDurations.height=`${i}ms`,this.updateTransitions()}screenToCanvasPoint(t,i){return{x:t-this.x,y:i-this.y}}getTransitionPromise(){return Promise.all(this.activeTransitions.map((t=>this.activeTransitionMap[t])).filter((t=>!!t)))}updateTransitions(){this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition()}applySize(){this._canvas.style.width=`${this.getNewWidth(this.containerBounds)}px`,this._canvas.style.height=`${this.getNewHeight(this.containerBounds)}px`}applyPosition(){this._canvas.style.left=`${this.getNewX(this.containerBounds)}px`,this._canvas.style.top=`${this.getNewY(this.containerBounds)}px`}stringifyTransitionDurations(){return Object.keys(this.transitionDurations).map((t=>this.transitionDurations[t])).join(",")}resolveActiveTransition(t){this.canvasBounds=this._canvas.getBoundingClientRect();const i=this.activeTransitions.indexOf(t);-1!==i&&this.activeTransitions.splice(i,1);const e=this.activeTransitionMap[t];e&&e.resolve(),this.activeTransitionMap[t]=null,this.transitionDurations[t]="0s"}hasActiveTransitions(){return this.activeTransitions.length>0}}},58095:(t,i,e)=>{e.d(i,{H:()=>a,P:()=>n});var s=e(7478);class n extends s.QB{constructor(t,i){super(),this.width=t,this.height=i}}class a extends s.QB{constructor(t){super(),this.orientation=t}}},94790:(t,i,e)=>{e.d(i,{Qm:()=>r,SK:()=>n,Ve:()=>h,_w:()=>o,jF:()=>a});var s=e(92475);class n extends s.E{constructor(t,i,e,s,n,a=0){super(t),this.position=i,this.buttons=e,this.device=s,this.ctrlKey=n,this.pointerId=a}}class a extends s.E{constructor(t,i,e,s,n,a,o=0){super(t),this.ctrlKey=!1,this.position=i,this.clientPosition=n,this.delta=e,this.buttons=s,this.device=a,this.pointerId=o}}class o extends s.E{constructor(t,i,e,s,n,a,o,r=0){super(t),this.ctrlKey=!1,this.position=i,this.delta=e,this.buttons=s,this.timeSinceLastMove=n,this.fullDelta=a,this.device=o,this.pointerId=r}}class r extends s.E{constructor(t,i,e){super(t),this.position=i,this.pointer=e}}class h extends s.E{constructor(t,i,e,s,n){super(t),this.position=i,this.startPosition=e,this.fullDelta=s,this.pointer=n}}},44667:(t,i,e)=>{e.d(i,{s:()=>n});var s=e(92475);class n extends s.E{constructor(t,i,e){super(t),this.position=i,this.delta=e}}},60043:(t,i,e)=>{e.d(i,{k:()=>n});var s=e(49586);class n extends s.T{constructor(t,i,e){super(),this.key=t,this.state=i,this.modifiers=e}}},90834:(t,i,e)=>{e.d(i,{O:()=>a});var s=e(12625),n=e(44351);class a extends s.B{constructor(){super(...arguments),this.name="interaction",this._source=a.defaultSource,this._mode=a.defaultMode}static get defaultMode(){return n.o.Desktop}static get defaultSource(){return n.m.None}get mode(){return this._mode}get source(){return this._source}updateSource(t){this._source=t}updateMode(t){this._mode=t}hasController(t=this.mode){return t===n.o.VrWithController||t===n.o.VrWithTrackedController}isVR(t=this.mode){return t===n.o.VrOrientOnly||t===n.o.VrWithTrackedController||t===n.o.VrWithController||t===n.o.VrTransientPointer||-1!==t.indexOf(n.o.VrUnknown)}isMobile(t=this.mode){return t===n.o.Mobile}}},45979:(t,i,e)=>{e.d(i,{z:()=>r});var s=e(37458),n=e(68909),a=e(19968),o=e(97831);class r extends n.Object3D{constructor(t){super(),this.cameraData=t,this.visible=!0,this.width=1,this.height=1,this.renderOrder=s.X.exteriorSplat}updateDepthBuffer(t,i,e){this.depthBuffer=t,this.width=i,this.height=e}raycast(t,i){if(this.depthBuffer&&this.visible){const e=h(t.ray,this.cameraData,this.depthBuffer,this.width,this.height);e&&i.push({distance:t.ray.origin.distanceTo(e.pt),object:this,point:e.pt.clone(),normal:e.normal.clone(),face:{a:-1,b:-1,c:-1,materialIndex:-1,normal:e.normal.clone()}})}}}const h=(()=>{const t=new n.Vector2,i=new n.Vector3,e=new n.Vector3,s=new n.Vector3,o=new n.Vector3,r=new n.Vector3,h=new n.Vector3,d=new n.Vector3;return(g,l,u,f,p)=>{const v=(0,a.jn)(g.origin,l.pose.position,l.pose.rotation,l.pose.projection.asThreeMatrix4());t.set(2/l.width,2/l.height);const y=c(v,t,l,u,f,p);i.copy(v),i.y+=10*t.y;const m=c(i,t,l,u,f,p);e.copy(v),e.y-=10*t.y;const w=c(e,t,l,u,f,p);s.copy(v),s.x-=10*t.y;const D=c(s,t,l,u,f,p);o.copy(v),o.x+=10*t.y;const R=c(o,t,l,u,f,p);if(y){const t=new n.Vector3(0,0,0);let i=0;const e=[m,D,w,R];for(let s=0;s<e.length;s++){const n=e[s],a=e[(s+1)%e.length];n&&a&&(r.subVectors(n,y).normalize(),h.subVectors(a,y).normalize(),d.crossVectors(r,h).normalize(),t.add(d),i++)}if(i>1)return t.multiplyScalar(1/i),{pt:y,normal:t}}return null}})(),c=(()=>{const t=Math.floor(5),i=new n.Vector2,e=new n.Vector2(1,1),s=new n.Vector2,r=new n.Vector2,h=new n.Vector3,c=new n.Vector3;return(d,g,l,u,f,p)=>{const v=new n.Vector3(0,0,0);let y=0;for(let n=-t;n<=t;n++)for(let m=-t;m<=t;m++){i.set(m*g.x,n*g.y),s.copy(d).add(i),r.copy(s).add(e).multiplyScalar(.5),r.x*=f,r.y*=p;const t=u[4*(Math.floor(r.y)*Math.floor(f)+Math.floor(r.x))]*o.t;if(t<o.t&&t>0){const i=l.pose.position,e=(0,a.Ft)(l.pose,h.set(s.x,s.y,1),h);e.sub(i).normalize(),c.copy(i).addScaledVector(e,t),v.add(c),y++}}return y<5?null:(v.multiplyScalar(1/y),v)}})()},81530:(t,i,e)=>{e.d(i,{F:()=>n});var s=e(11165);class n extends s.u{constructor(t){super(),this.payload=t}}n.id="SAVE_COMMAND"},78498:(t,i,e)=>{function s(t){return{x:t.x,y:t.y,z:t.z}}function n(t){return{x:t.x||t._x,y:t.y||t._y,z:t.z||t._z,w:t.w||t._w}}e.d(i,{I:()=>s,p:()=>n})},79243:(t,i,e)=>{e.d(i,{n:()=>s});const s=(t,i)=>{let e,s=Date.now()-i;return(...n)=>{const a=Date.now()-s,o=()=>{t.apply(null,n),s=Date.now()};if(e&&clearTimeout(e),a>=i)o();else{const t=i-a;e=window.setTimeout(o,t)}}}},80783:(t,i,e)=>{e.d(i,{h:()=>n});var s=e(7478);class n extends s.QB{constructor(t,i){super(),this.width=t,this.height=i}}},81547:(t,i,e)=>{var s;e.d(i,{D:()=>s}),function(t){t[t.Immediate=0]="Immediate",t[t.NextFrame=1]="NextFrame",t[t.Duration=2]="Duration",t[t.Manual=3]="Manual",t[t.Debounced=4]="Debounced"}(s||(s={}))},97234:(t,i,e)=>{e.d(i,{Xw:()=>s,gj:()=>h,jz:()=>c});var s,n=e(64200),a=e(5894),o=e(75772),r=e(81547);!function(t){t.added="added",t.removed="removed",t.updated="updated"}(s||(s={}));class h{constructor(t,i,e){this.index=t,this.action=i,this.diff=e}}class c{constructor(t,i){if(this.changedHandlers=[],this.awaitingInvoke=!1,this.diffRecord=[],this.targetMonitors={},this.triggerChangeHandlers=this.invokeChangeHandlers.bind(this),this.config=t,this.updatePhaseSync=i,this.config.aggregationType===r.D.NextFrame){if(!i)throw Error("UpdatePhaseSync required for NextFrame aggregation")}else{if(this.config.aggregationType===r.D.Duration)throw Error("Aggregation Type not implemented");this.config.aggregationType===r.D.Debounced&&(this.triggerChangeHandlers=(0,n.s)(this.invokeChangeHandlers.bind(this),t.aggregationDuration))}}hasDiffRecord(){return this.diffRecord.length>0}clearDiffRecord(){this.diffRecord=[];for(const t in this.targetMonitors){const i=this.targetMonitors[t];i.hasDiffRecord()&&i.clearDiffRecord()}this.awaitingInvoke=!1}onChanged(t){this.changedHandlers.push(t)}removeOnChanged(t){(0,a.Nz)(this.changedHandlers,t)}invokeCallbacks(t){if(this.changedHandlers.length>0)for(const i of this.changedHandlers)i(t)}invokeChangeHandlers(t){var i;switch(this.config.aggregationType){case r.D.Immediate:case r.D.Debounced:this.invokeCallbacks(t);break;case r.D.NextFrame:this.awaitingInvoke||(this.awaitingInvoke=!0,null===(i=this.updatePhaseSync)||void 0===i||i.after(o.R.End).then((()=>{this.awaitingInvoke&&(this.invokeCallbacks(t),this.awaitingInvoke=!1)})));case r.D.Manual:}}}},92953:(t,i,e)=>{e.d(i,{F:()=>o});var s=e(69304),n=e(97234),a=e(56287);class o extends n.jz{constructor(t,i,e){super(i,e),this.target=t;for(const s of t.keys){const n=t.get(s),o=new a.V(n,i,e);o.onChanged(this.triggerChangeHandlers),this.targetMonitors[s]=o}const o={onAdded:(t,o)=>{const r=new a.V(t,i,e);r.onChanged(this.triggerChangeHandlers),this.targetMonitors[o]=r;const h=this.diffRecord.findIndex((t=>t.index===o));-1!==h&&this.diffRecord.splice(h,1);const c=new n.gj(o,n.Xw.added,(0,s.A4)(t));-1===h&&this.diffRecord.push(c),this.triggerChangeHandlers(c)},onRemoved:(t,i)=>{delete this.targetMonitors[i];const e=this.diffRecord.findIndex((t=>t.index===i));-1!==e&&this.diffRecord.splice(e,1);const a=new n.gj(i,n.Xw.removed,(0,s.A4)(t));-1===e&&this.diffRecord.push(a),this.triggerChangeHandlers(a)}};this.target.onElementChanged(o)}commitChanges(){this.invokeCallbacks(this.getDiffRecord())}getDiffRecord(){const t=[];for(const i in this.targetMonitors){const e=this.targetMonitors[i];if(e.hasDiffRecord()){const a=e.getDiffRecord(),o=this.diffRecord.findIndex((t=>t.index===i));-1!==o?(0,s.h1)(this.diffRecord[o].diff,a):t.push(new n.gj(i,n.Xw.updated,a))}}return this.diffRecord.concat(t)}}},56287:(t,i,e)=>{e.d(i,{V:()=>h});var s=e(64200),n=e(69304),a=e(5894),o=e(75772),r=e(81547);class h{constructor(t,i,e){this.updatePhaseSync=e,this.target=t,this.clearDiffRecord(),this.aggregationType=i.aggregationType,this.aggregationType===r.D.Debounced&&(this.handleAggregation=(0,s.s)(this.handleAggregation.bind(this),i.aggregationDuration||30)),this.target.onChanged((()=>{this.diffRecord=(0,n.bB)(this.originalData,(0,n.A4)(this.target),i.shallow),this.handleAggregation()})),this.changedHandlers=[]}hasDiffRecord(){return Object.keys(this.diffRecord).length>0}getDiffRecord(){return this.diffRecord}clearDiffRecord(){this.originalData=(0,n.A4)(this.target),this.diffRecord={}}onChanged(t){this.changedHandlers.push(t)}removeOnChanged(t){(0,a.Nz)(this.changedHandlers,t)}commitChanges(){this.triggerChangeHandlers(this.diffRecord)}handleAggregation(){switch(this.aggregationType){case r.D.Immediate:this.triggerChangeHandlers(this.diffRecord);break;case r.D.NextFrame:if(!this.updatePhaseSync)throw new Error("handleAggregation() -> Next frame aggregation requested, but updatePhaseSync is null");this.nextFramePromise||(this.nextFramePromise=this.updatePhaseSync.after(o.R.Begin).then((()=>{this.triggerChangeHandlers(this.diffRecord)})).finally((()=>{this.nextFramePromise=void 0})));break;case r.D.Debounced:this.triggerChangeHandlers(this.diffRecord);break;case r.D.Duration:throw new Error("AggregationType.Duration: Please implement me :)");case r.D.Manual:}}triggerChangeHandlers(t){if(this.changedHandlers.length>0)for(const i of this.changedHandlers)i(t)}}},1284:(t,i,e)=>{var s;e.d(i,{p:()=>s}),function(t){t.BLURS="blurs",t.BLUR_SUGGESTIONS="blur-suggestions",t.FLOORS="floors",t.HIGHLIGHTS="highlights",t.LABELS="labels",t.MATTERTAGS="mattertags",t.MEASUREMENTS="measurements",t.NOTES="notes",t.OBJECT_ANNOTATIONS="objectAnnotations",t.ORDERED_LISTS="orderedLists",t.PHOTOS="photos",t.PLUGINS="plugins",t.SETTINGS="settings",t.START_LOCATION="startlocation",t.SWEEPS="sweeps",t.LAYERS="layers",t.ROOM_BOUNDS="room_bounds"}(s||(s={}))},28337:(t,i,e)=>{var s;e.d(i,{$:()=>s}),function(t){t[t.DOWN=0]="DOWN",t[t.PRESSED=1]="PRESSED",t[t.UP=2]="UP"}(s||(s={}))},72268:(t,i,e)=>{var s,n;e.d(i,{O:()=>n,m:()=>s}),function(t){t[t.PRIMARY=0]="PRIMARY",t[t.MIDDLE=1]="MIDDLE",t[t.SECONDARY=2]="SECONDARY",t[t.BACK=3]="BACK",t[t.FORWARD=4]="FORWARD",t[t.COUNT=5]="COUNT"}(s||(s={})),function(t){t[t.NONE=0]="NONE",t[t.PRIMARY=1]="PRIMARY",t[t.SECONDARY=4]="SECONDARY",t[t.MIDDLE=2]="MIDDLE",t[t.BACK=8]="BACK",t[t.FORWARD=16]="FORWARD",t[t.ALL=31]="ALL"}(n||(n={}))},51666:(t,i,e)=>{e.d(i,{Z:()=>n});var s=e(25481);function n(t){if(t&&"object"==typeof t&&"x"in t&&"y"in t&&"z"in t){const i=t;return(0,s.Et)(i.x)&&(0,s.Et)(i.y)&&(0,s.Et)(i.z)}return!1}}}]);