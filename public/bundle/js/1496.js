/*! For license information please see 1496.js.LICENSE.txt */
"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[1496],{76185:(e,t,i)=>{function o(e){if(null==e)throw new Error(`Expected a defined value but got ${e} instead`)}i.d(t,{$:()=>o})},15934:(e,t,i)=>{var o;i.d(t,{A:()=>s}),function(e){e[e.GL_TEXTURE_CUBE_MAP_POSITIVE_X=0]="GL_TEXTURE_CUBE_MAP_POSITIVE_X",e[e.GL_TEXTURE_CUBE_MAP_NEGATIVE_X=1]="GL_TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.GL_TEXTURE_CUBE_MAP_POSITIVE_Y=2]="GL_TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y=3]="GL_TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.GL_TEXTURE_CUBE_MAP_POSITIVE_Z=4]="GL_TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z=5]="GL_TEXTURE_CUBE_MAP_NEGATIVE_Z"}(o||(o={}));const s=o},46147:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(52018);class s extends o.t{constructor(e="Out of range"){super(e),this.name="OutOfRangeException"}}},65936:(e,t,i)=>{i.d(t,{m:()=>s});var o=i(11165);class s extends o.u{constructor(e,t,i){super();const o=function*(){return t()}();this.payload={type:e,func:o,maxDelay:i,steps:1}}}s.id="SCHEDULE_TASK_COMMAND"},46140:(e,t,i)=>{i.d(t,{A:()=>n});var o,s=i(76318),r=i(8333);!function(e){e[e.Untested=0]="Untested",e[e.Testing=1]="Testing",e[e.Success=2]="Success",e[e.Fail=3]="Fail"}(o||(o={}));class n{constructor(e,t,i,o){this.maxCubemapSize=e,this.maxNavPanoSize=t,this.maxZoomPanoSize=i,this.overrideWindow=!1,this.navPanoSize=s.c5.STANDARD,this.zoomPanoSize=s.c5.STANDARD,this.defaultMaxNavPanoSize=this.maxNavPanoSize,this.resolution=o,this.highQualityThreshold=r.W0.windowHeightHighQualityThresholdOverride||r.W0.windowHeightHighQualityThreshold,this.updateMaximums()}update({height:e,fov:t}){this.resolution=e,this.updateMaximums()}overrideWindowMaximums(e){this.overrideWindow=e,this.updateMaximums()}overrideNavPanoSize(e){this.maxNavPanoSize=null!=e?e:this.defaultMaxNavPanoSize,this.updateMaximums()}updateMaximums(){this.resolution<this.highQualityThreshold&&!this.overrideWindow?(this.navPanoSize=Math.min(n.getPanoSize(s.MF.STANDARD),this.maxNavPanoSize),this.zoomPanoSize=Math.min(n.getPanoSize(s.MF.HIGH),this.maxZoomPanoSize)):(this.navPanoSize=this.maxNavPanoSize,this.zoomPanoSize=this.maxZoomPanoSize),this.zoomPanoSize<this.navPanoSize&&(this.navPanoSize=this.zoomPanoSize),this.zoomPanoSize=Math.min(this.maxCubemapSize,this.zoomPanoSize),this.navPanoSize=Math.min(this.maxCubemapSize,this.navPanoSize)}static getPanoSize(e){if(e in s.oY)return s.oY[e];throw new Error(`Not a panoSizeClass: ${e}`)}static getPanoSizeClass(e){if(e in s.Mo)return s.Mo[e];throw new Error(`Not a valid pano resolution: ${e}`)}getNavPanoSize(){return this.navPanoSize}getZoomPanoSize(){return this.zoomPanoSize}}},11018:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(7478);class s extends o.QB{constructor(e,t,i){super(),this.size=e,this.sweepId=t,this.renderTarget=i}}},10574:(e,t,i)=>{i.d(t,{V:()=>s});var o=i(11165);class s extends o.u{constructor(e){super(),this.payload={navSize:e}}}s.id="SET_NAV_PANO_SIZE"},91496:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ee});var o=i(64882),s=i(80783),r=i(68920),n=i(71687),a=i(8333),l=i(75772),u=i(9139),h=i(68909),d=i(15934),c=i(46147);const p={0:d.A.GL_TEXTURE_CUBE_MAP_POSITIVE_Y,1:d.A.GL_TEXTURE_CUBE_MAP_POSITIVE_Z,2:d.A.GL_TEXTURE_CUBE_MAP_POSITIVE_X,3:d.A.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z,4:d.A.GL_TEXTURE_CUBE_MAP_NEGATIVE_X,5:d.A.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y},g=e=>{if(e<0||e>5)throw new c.A("mapFaceToCubemapFace() -> face must be in the range [0, 5]");return p[e]};var w=i(76318),f=i(50178),m=i(65936),T=i(64713);class S{constructor(e){this._value=e}value(){return this._value}set(e){this._value=e}}class v{constructor(){this.storage={}}get(e,t){let i=this.storage[e];return i||(i=t(),this.storage[e]=i),i}getNumber(e){return this.get(e,(()=>new S(0)))}getString(e){return this.get(e,(()=>new S("")))}getArray(e){return this.get(e,(()=>[]))}getNumberMap(e){return this.get(e,(()=>({})))}getStringMap(e){return this.get(e,(()=>({})))}}var D,P=i(73586),y=i(81662),z=i(11018),R=i(46140);!function(e){e[e.Center=0]="Center",e[e.UpperLeft=1]="UpperLeft",e[e.UpperRight=2]="UpperRight",e[e.LowerRight=3]="LowerRight",e[e.LowerLeft=4]="LowerLeft"}(D||(D={}));const Q=D;var A=i(53172);const F=512,U=(e,t,i,o,s,r,n,a)=>{const l=e/t,u=2*(t/e),h=u/2;let c=2*(o/l)-1+h,p=2*((s=l-1-s)/l)-1+h;switch(r=r||Q.Center){case Q.UpperLeft:c-=h,p+=h,c+=n*u;break;case Q.UpperRight:c+=h,p+=h,p-=n*u;break;case Q.LowerRight:c+=h,p-=h,c-=n*u;break;case Q.LowerLeft:c-=h,p-=h,p+=n*u;case Q.Center:}switch(i){case d.A.GL_TEXTURE_CUBE_MAP_POSITIVE_X:a.set(-1,p,-c);break;case d.A.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:a.set(1,p,c);break;case d.A.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:a.set(-c,1,-p);break;case d.A.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:a.set(-c,-1,p);break;case d.A.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:a.set(-c,p,1);break;case d.A.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:a.set(c,p,-1)}a.normalize()},x=(e,t)=>{let i=F;e<F&&(i=e);const o=Math.floor(e/i),s=o*o;return Math.floor(t/s)},M=(e,t,i)=>{let o=F;e<F&&(o=e);const s=x(e,t),r=Math.floor(e/o),n=t-s*(r*r);i.tileX=n%r,i.tileY=Math.floor(n/r),i.face=s,i.faceTileIndex=n},b=function(e){if(e<=F)return 6;const t=Math.floor(e/F);return 6*(t*t)},I=function(){const e=new h.Matrix4,t=new h.Quaternion;return(i,o)=>{t.copy(i),t.invert(),e.makeRotationFromQuaternion(t),o.applyMatrix4(e),o.normalize()}}(),E=function(){const e=new h.Vector3,t=new h.Vector3(0,0,-1),i=new h.Quaternion,o=function(e,t){e.push({face:t.face,faceTileIndex:t.faceTileIndex,tileX:t.tileX,tileY:t.tileY})},s=function(){const e={face:-1,faceTileIndex:-1,tileX:-1,tileY:-1};return(t,i,s)=>{const r=b(t);let n=0;for(let a=0;a<r;a++)M(t,a,e),i&&!i(e)||(n++,s&&o(s,e));return n}}();return(o,r,n,a,l=!1,u,d)=>{a.length=l?0:a.length;const c=r<F?r:F;if(!u&&!d)return s(r,null,a);const p=!!d;u=u||0,d=d||u,d=Math.max(0,Math.min(d,360)),u=Math.max(0,Math.min(u,360)),e.copy(n);const g=o.rotation||new h.Quaternion;if(I(g,e),p){i.setFromUnitVectors(e,t);return s(r,(function(e){return C(r,c,e.face,e.tileX,e.tileY,i,u||0,d||0)}),a)}return s(r,(function(t){return _(r,c,t.face,t.tileX,t.tileY,e,u||0)}),a)}}(),C=function(){const e=new h.Vector3;return(t,i,o,s,r,n,a,l)=>{const u=Math.tan(.5*l*A.fy),h=-u,d=Math.tan(.5*a*A.fy),c=-d,p=g(o);let w=0,f=0,m=0,T=0,S=0;for(let o=Q.Center;o<=Q.LowerLeft;o++){if(U(t,i,p,s,r,o,0,e),e.applyQuaternion(n),e.z>=-1e-5)continue;const a=-1/e.z,l=e.x*a,g=e.y*a;g>u?w++:g<h&&f++,l>d?m++:l<c&&T++,S++}return f!==S&&w!==S&&m!==S&&T!==S}}(),_=function(){const e=new h.Vector3,t=new h.Vector3(0,1,0),i=new h.Vector3(1,0,0);return(o,s,r,n,a,l,u)=>{const h=g(r);if(i.copy(l).cross(t),U(o,s,h,n,a,Q.Center,0,e),L(e,l,u))return!0;const d=u/360,c=Math.floor(1/d);let p=0;for(let t=0;t<c;t++){for(let t=Q.UpperLeft;t<=Q.LowerLeft;t++)if(U(o,s,h,n,a,t,p,e),L(e,l,u))return!0;p+=d}return!1}}(),L=function(){const e=new h.Vector3,t=new h.Vector3;return(i,o,s,r)=>{if(t.copy(i),r){e.copy(r),e.normalize();const o=e.dot(i);e.x*=o,e.y*=o,e.z*=o,t.sub(e)}const n=s/2*A.fy,a=Math.cos(n);return t.dot(o)>=a}}();var V;!function(e){e[e.PreOrder=0]="PreOrder",e[e.PostOrder=1]="PostOrder"}(V||(V={}));class N{constructor(e,t){this.tree=e,this.parent=t,this.children=[],this.id=++N._id,this.extra={},this.level=-1}}N._id=0;class O{constructor(e,t){this.levels=t,this.tileSize=e,this.root=null,this.allNodes=[],q(this)}getSizeForLevel(e,t){return Math.pow(2,t)*e}getSubNode(e,t,i){(!t||e<this.tileSize)&&(t=0),(!i||e<this.tileSize)&&(i=0),e<this.tileSize&&(e=this.tileSize);const o=H(this.tileSize,e);return X(this.root,0,o,t,i)}deleteAllNodes(){this.depthFirst(function(e,t,i,o,s){for(let t=0;t<e.children.length;t++){const i=e.children[t];i&&(i.parent=null,i.tree=null),e.children[t]=null}e.children.length=0}.bind(this),null,V.PostOrder);for(let e=0;e<this.allNodes.length;e++){const t=this.allNodes[e];t&&(t.parent=null,t.tree=null),this.allNodes[e]=null}this.allNodes.length=0,this.root=null}breadthFirst(e){const t=!!(e=e||{}).nullLevelEnd,i=e.maxLevel,o=e.minLevel,s=e.callback,r=e.saveVisited,n=[],a=new N(this,null);let l=0;if(this.root)for(n.push(this.root),n.push(a);n.length>0&&!(i&&l>i);){const e=n.shift();if(e)if(e===a)(!o||l>=o)&&(s&&t&&s(),r&&t&&r.push(null)),n.length>0&&n.push(a),l++;else{if(e.children)for(const t of e.children)t&&n.push(t);const t=this.getFaceIndexFromNode(e);(!o||l>=o)&&(s&&s(e,l,t),r&&r.push(e))}}}getFaceIndexFromNode(e){if(!e)return-1;let t=1,i=e,o=0,s=0;for(;;){const e=i.parent;if(!e)break;let r=-1;for(let t=0;t<e.children.length;t++)e.children[t]===i&&(r=t);o=r%2*t+o,s=Math.floor(r/2)*t+s,t*=2,i=e}return s*t+o}depthFirst(e,t,i){B(this.root,0,0,0,e,t,i,this.tileSize)}}const H=function(e,t){let i=0;for(t<e&&(t=e);!((t/=2)<e);)i++;return i},B=function(e,t,i,o,s,r,n,a){if(!e)return;const l=2*o+i;if((n=n||V.PreOrder)===V.PreOrder&&(s&&s(e,t,l,i,o),r&&r.push(e)),!e.children||0===e.children.length)return;const u=2*o,h=2*i;for(let i=0;i<2;i++)for(let o=0;o<2;o++)B(e.children[2*o+i],t+1,h+i,u+o,s,r,n,a);n===V.PostOrder&&(s&&s(e,t,l,i,o),r&&r.push(e))},q=e=>{e.root=G(e,null,0)},G=(e,t,i)=>{if(i>e.levels)return null;const o=new N(e,t);o.level=i,e.allNodes.push(o);for(let t=0;t<4;t++){const s=G(e,o,i+1);s&&(o.children[t]=s)}return o},X=(e,t,i,o,s)=>{if(!e)return null;if(0===i)return e;{if(!e.children||0===e.children.length)return null;const r=Math.pow(2,i)/2,n=o%r,a=s%r,l=2*Math.floor(s/r)+Math.floor(o/r),u=e.children[l];return X(u,t+1,i-1,n,a)}};var k,Z=i(52018);class Y extends Z.t{constructor(e){super(e),this.name="PanoTilingError"}}!function(e){e[e.Base=0]="Base",e[e.Remaining=1]="Remaining"}(k||(k={}));class W{constructor(e){this.tilePrioritizer=e,this.forceQueue=[],this.uploadQueues={},this.panoLODDescriptors={}}addToForceQueue(e){this.forceQueue.push(e)}addToPanoQueue(e,t){this.getUploadQueueForPano(e).push(t)}insertSortedIntoPanoQueue(e,t,i,o){const s=this.getUploadQueueForPano(i.id);this.tilePrioritizer.insertSortedPanoTile(e,s,t,i,o)}sortQueue(e,t){const i=this.getUploadQueueForPano(e.id);this.tilePrioritizer.sortTiles(i,e,t)}getUploadQueueForPano(e){let t=this.uploadQueues[e];return t||(t=[],this.uploadQueues[e]=t),t}hasQueuedTiles(){if(this.forceQueue.length>0)return!0;for(const e in this.uploadQueues){const t=this.getUploadQueueForSweep(e);if(t&&t.length>0)return!0}return!1}getUploadQueueForSweep(e){let t=this.uploadQueues[e];return t||(t=[],this.uploadQueues[e]=t),t}getTopUploadQueue(e){let t=null;for(let i=k.Base;i<=k.Remaining;i++)for(const o of e)if(t=this.getUploadQueueForSweep(o.id),t.length>0)switch(i){case k.Base:if(0===t[0].level)return t;break;case k.Remaining:return t}return null}processNextQueueItem(e){const t=e.shift();return t?(t.uploadQueued=!1,t):null}getNextFromUploadQueue(e){if(this.forceQueue.length>0)return this.processNextQueueItem(this.forceQueue);const t=this.getTopUploadQueue(e);return t&&t.length>0?this.processNextQueueItem(t):null}peekNextFromUploadQueue(e){if(this.forceQueue.length>0)return this.forceQueue[0];const t=this.getTopUploadQueue(e);return t&&t.length>0?t[0]:null}clearAllQueuedUploads(){this.clearAllUploadQueues(null,0)}clearAllUploadQueues(e,t=0){if(e)this.clearUploadQueue(this.getUploadQueueForSweep(e),t),this.clearUploadQueue(this.forceQueue,t,e);else{for(const e in this.uploadQueues)this.clearUploadQueue(this.getUploadQueueForSweep(e),t);this.clearUploadQueue(this.forceQueue,t)}}clearUploadQueue(e,t=0,i){let o=0;for(;o<e.length;){const s=e[o];(!i||i&&i===s.sweepId)&&s.level>=t?(s.uploadQueued=!1,e.splice(o,1)):o++}}resetPanoLODDescriptors(e){const t=this.getPanoLODDescriptors(e);for(const e in t)if(t.hasOwnProperty(e)){const i=t[e];i.uploadCount=0,i.uploadAttempts=0}}getPanoLODDescriptor(e,t){const i=this.getPanoLODDescriptors(e);let o=i[t];return o||(o={uploadCount:0,uploadAttempts:0},i[t]=o),o}getPanoLODDescriptors(e){let t=this.panoLODDescriptors[e];return t||(t={},this.panoLODDescriptors[e]=t),t}}const j=new u.Vy("tiles"),$=a.W0.uploadIntervalDelay;class K{constructor(e,t,i,o,s,r,n,a){this.cwfRenderer=e,this.panoQualityManager=t,this.tileDownloader=i,this.tilePrioritizer=o,this.sweepData=s,this.cameraModule=r,this.raycasterData=n,this.tilingSettings=a,this.persistentStorage=new v,this.tempTileTextures=new Map,this.componentActive=!1,this.activeSweeps=[],this.sweepLoadHistory=[],this.activeRenderTargetDescriptors={},this.panoLoadMinimumCallbacks={},this.panoLoadPromises={},this.panoLoadResolvers={},this.tileDirectory={},this.tileTrees={},this.usingTileOverlay=!1,this.overlayTilesLoaded=!1,this.overlayTiles={},this.currentState=new Map,this.bindings=[],this.textureUsageCounter={},this.tileUploadQueue=new W(this.tilePrioritizer),this.renderTargetPool=new P.i(((e,t)=>e.object.height===t.size&&e.object.width===t.size)),this.onTileDownLoaded=this.onTileDownLoaded.bind(this);const l=e=>{this.currentState.set(e,new J),this.tilePrioritizer.createCriteria(e)},u=e=>{this.currentState.delete(e),this.tilePrioritizer.removeCritera(e)};for(const e of this.cameraModule.cameraDatas.keys)l(e);this.bindings.push(this.cameraModule.cameraDatas.onElementChanged({onAdded:(e,t)=>l(t),onRemoved:(e,t)=>u(t)}))}render(){}activate(e){this.engine=e,this.componentActive=!0;for(const e of this.getActivePanos())this.resetUploadState(e,!0,!0),this.clearAllQueuedUploadsForPano(e),this.renderPanoTiles(e,null,!0,!0)}deactivate(){this.clearAllQueuedUploads(),this.tempTileTextures.forEach((e=>e.dispose())),this.tempTileTextures.clear(),this.renderTargetPool.all().forEach((({object:e})=>null==e?void 0:e.dispose())),this.componentActive=!1}dispose(){for(const e of this.bindings)e.cancel();this.bindings.length=0}getActivePanos(){const e=[];for(const t of Object.keys(this.activeRenderTargetDescriptors)){this.activeRenderTargetDescriptors[t]&&e.push(t)}return e}init(){this.loadOverlayTiles()}_activateSweep(e){this.textureUsageCounter[e]||(this.textureUsageCounter[e]=0)}_useTexture(e){this.textureUsageCounter[e]++}_freeTexture(e){this.textureUsageCounter[e]>0&&this.textureUsageCounter[e]--}_setTextureUsage(e,t){this.textureUsageCounter[e]=t}_freeUnusedTextures(){for(const e of Object.keys(this.textureUsageCounter))0===this.textureUsageCounter[e]&&this.freeTexture(e)}highResRenderTarget(e,t){const i=this.getCurrentState();if(e){if(!t)throw new Y("Cannot activate zooming without sweepId!");i.zoomingActive=!0,i.zoomSweepId=t,this.copyTargetToZoom(t,i)}else i.zoomingActive=!1,i.zoomSweepId=null;if(t){const e=this.getRenderTargetDescriptorForSweep(t);if(!e)throw new Y("Zooming at a null render target!");const o=i.zoomingActive?i.zoomRenderTarget:e.object,s=o.width;this.engine.broadcast(new z.A(s,t,o))}}getCurrentPanoResolution(){const e=Array.from(this.currentState.values()).find((e=>e.zoomingActive))?this.panoQualityManager.getZoomPanoSize():this.panoQualityManager.getNavPanoSize();return R.A.getPanoSizeClass(e)}beforeRenderViewport(){const e=this.cameraModule.cameraData,t=this.getCurrentState();if(t.position.copy(e.pose.position),t.rotation.copy(e.pose.rotation),t.direction.copy(y.B1.FORWARD).applyQuaternion(e.pose.rotation),this.tileUploadQueue.hasQueuedTiles())for(const i of this.activeSweeps)i.cameraIds.has(e.id)&&this.tileUploadQueue.sortQueue(i.sweep,t.direction);const i=this.sweepData.state.transition.to,o=this.sweepData.state.currentSweep,s=i||o||t.sweepId;s&&(t.sweepId=s);const r=s?this.sweepData.getSweep(s):null;r&&this.tilePrioritizer.updateCriteria(e.id,e.priority,r,t.position,t.direction,t.rotation,this.raycasterData.hit),this.updateUploadQueueProcessing()}activateSweep(e,t=!0){this._activateSweep(e);const i=this.sweepData.getSweep(e);if(!i)throw j.error(e,i),new Y("Invalid sweepId passed to TiledPanoRenderer.activate()");let o=this.panoLoadPromises[e];if(!o){const s=(()=>{const i=this.engine;let o;return t&&(o=window.setTimeout((()=>{i.broadcast(new f.XR(!0))}),a.W0.loadIndicatorDelay)),this._useTexture(e),()=>{clearTimeout(o),i.broadcast(new f.XR(!1)),this._freeTexture(e)}})();t&&(this.panoLoadMinimumCallbacks[e]=s);const r=this.cameraModule.cameraData.id,n=this.getCurrentState(r);o=new Promise(((t,o)=>{this.panoLoadResolvers[e]=t,this.activatePano(i,r),this.queueUploadForAllTiles(e,n),this.tileDownloader.forceQueueTiles(i,w.c5.BASE,n.direction,!0,r)})),this.panoLoadPromises[e]=o}return o}useTexture(e,t=this.cameraModule.cameraData.id){const i=this.getRenderTargetDescriptorForSweep(e);if(!i)throw j.error(e),new Y("Texture for sweep not activated before using");const o=i.object.texture;this._useTexture(e),this._freeUnusedTextures();const s=this.getCurrentState(t);return s.zoomingActive?s.zoomRenderTarget.texture:o}freeTexture(e){this._freeTexture(e),0===this.textureUsageCounter[e]&&this.deactivatePano(e)}freeAllTextures(e=[]){const t=(0,T.Z)(e),i=this.getActivePanos();for(const e of i)t[e]||this.freeTexture(e)}enableUltraHighQualityMode(e){const t=this.getCurrentState();this.setupZoomRenderTarget(t),t.zoomSweepId&&this.engine.broadcast(new z.A(t.zoomRenderTarget.width,t.zoomSweepId,t.zoomRenderTarget))}resetRenderStatus(e,t,i,o){let s;o&&(s=H(F,o)+1);const r=(e,o,s,r)=>{i&&(o.extra.tile.zoomUploaded=!1),t&&(o.extra.tile.uploaded=!1)};for(let t=0;t<6;t++){this.getTileTree(e,t).breadthFirst({callback:r.bind(this,t),minLevel:s})}}copyBaseRenderStatusToZoomed(e){const t=H(F,this.panoQualityManager.getNavPanoSize()),i=(e,t,i,o)=>{t.extra.tile.zoomUploaded=t.extra.tile.uploaded,t.extra.zoomCovered=t.extra.covered};for(let o=0;o<6;o++){this.getTileTree(e,o).breadthFirst({callback:i.bind(this,o),maxLevel:t})}}renderPanoTiles(e,t,i,o){const s=[],r=this.getCurrentState();r.zoomRenderTarget&&r.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize()||r.zoomSweepRenderingDisabled||this.setupZoomRenderTarget(r);const n=this.getCurrentState(this.cameraModule.cameraData.id);t=t||n.direction||y.B1.FORWARD;const a=this.getRenderTargetDescriptorForSweep(e);if(!this.isRenderTargetDescriptorValid(a))throw new Y("PanoRenderer.renderPanoTiles() -> Cannot render to a pano that is not activated.");for(let t=0;t<6;t++){const r=this.getTileTree(e,t);s.length=0,r.breadthFirst({saveVisited:s});for(let e=0;e<s.length;e++){const t=s[e];this.queueUploadForTile(t.extra.tile,!1,n,o||0===e&&i)}}}clearAllQueuedUploads(){this.tileUploadQueue.clearAllUploadQueues(null,0)}clearAllQueuedUploadsForPano(e){this.tileUploadQueue.clearAllUploadQueues(e,0)}activatePano(e,t){this.tileUploadQueue.clearAllQueuedUploads();const i=e.availableResolution(w.MF.ULTRAHIGH),o=w.oY[i],s=e.id;for(let i=0;i<6;i++){let r=this.tileTrees[s];r||(r=[],this.tileTrees[s]=r);let n=r[i];if(!n){const s=H(F,o);n=new O(F,s),r[i]=n,n.breadthFirst({callback:(o,s,r)=>{const n=this.getTileDirectoryEntry(e.id,i,s,r,t);o.extra.tile=n,n.node=o}})}}let r=this.getRenderTargetDescriptorForSweep(e.id);if(!r){const t=this.panoQualityManager.getNavPanoSize();if(r=this.renderTargetPool.get({size:t}),!r){const e=this.cwfRenderer.initRenderTargetCube(t);r=this.renderTargetPool.add(e),r.extra={},r.extra.size=e.width}r.extra.sweep=e,r.extra.sweepindex=e.index,this.activeRenderTargetDescriptors[e.id]=r,this.tileUploadQueue.resetPanoLODDescriptors(e.id),this.resetUploadState(e.id,!0,!0)}return this.updateActiveSweeps({sweep:e,cameraIds:new Set([t])}),r.object}deactivatePano(e){const t=this.getRenderTargetDescriptorForSweep(e);t&&this.isRenderTargetDescriptorValid(t)&&(this.renderTargetPool.free(t.object),this.activeRenderTargetDescriptors[e]=null,this.updateActiveSweeps(),this.tileUploadQueue.clearAllUploadQueues(e),this.tileUploadQueue.resetPanoLODDescriptors(e),this.clearCachedTileData(),delete this.panoLoadPromises[e])}clearCachedTileData(){for(let e=this.sweepLoadHistory.length-1;e>=0;e--){let t=!1;const i=this.sweepLoadHistory[e];if(i){for(const e of this.activeSweeps)if(i===e.sweep.id){t=!0;break}t||(this.checkTileTreeInitialized(i)&&(this.clearTileState(i,!0,!0),this.deleteTileTrees(i)),this.deleteTileDirectoryEntries(i),this.tileDownloader.deleteAllTileDownloadDescriptors(i),this.sweepLoadHistory[e]=null)}}this.updateSweepLoadHistory()}updateActiveSweeps(e){const t=this.persistentStorage.getArray("updateActiveSweeps:tempSweeps");t.length=0;let i=null;for(const o of this.activeSweeps){const s=this.getRenderTargetDescriptorForSweep(o.sweep.id);e&&o.sweep.id===e.sweep.id||!this.isRenderTargetDescriptorValid(s)||(t.push(o),e&&o.sweep.id===e.sweep.id&&(i=o))}if(e)if(i)for(const t of e.cameraIds.values())i.cameraIds.add(t);else t.unshift(e);this.activeSweeps.length=0,this.activeSweeps.push(...t)}queueUploadForAllTiles(e,t){t.zoomRenderTarget&&t.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize()||t.zoomSweepRenderingDisabled||this.setupZoomRenderTarget(t);const i=this.getRenderTargetDescriptorForSweep(e);if(!this.isRenderTargetDescriptorValid(i))throw new Y("queueUploadForAllTiles() -> Cannot render to a pano that is not activated.");const o=this.persistentStorage.getArray("queueUploadForAllTiles:nodeList");for(let i=0;i<6;i++){const s=this.getTileTree(e,i);o.length=0,s.breadthFirst({saveVisited:o});for(const e of o)this.queueUploadForTile(e.extra.tile,!1,t,0===e.level)}}onTileDownLoaded(e){if(!e.sweep||!e.criteriaId)return;const t=H(F,e.panoSize),i=this.getTileDirectoryEntry(e.sweep.id,e.face,t,e.faceTileIndex,e.criteriaId);this.updateUploadDescriptorFromDownloadDescriptor(i,e),this.updateSweepLoadHistory(i.sweepId);const o=this.getRenderTargetDescriptorForSweep(i.sweepId);if(this.isRenderTargetDescriptorValid(o)){const t=this.getTileTree(i.sweepId,i.face).getSubNode(i.panoSize,i.tileX,i.tileY);t&&(t.extra.tile=i,i.node=t,this.componentActive&&this.queueUploadForTile(i,!0,this.getCurrentState(e.criteriaId)))}}updateUploadDescriptorFromDownloadDescriptor(e,t){var i,o;e.downloaded=!0,e.image&&e.image!==t.image&&(null===(o=(i=e.image).close)||void 0===o||o.call(i)),e.image=t.image,e.panoSize=t.panoSize,e.tileX=t.tileX,e.tileY=t.tileY,e.totalTiles=t.totalTiles,e.tileIndex=t.tileIndex,e.faceTileIndex=t.faceTileIndex,e.face=t.face,e.cubeFace=g(t.face),t.sweep&&(e.sweepId=t.sweep.id),e.tileSize=t.tileSize,e.direction.copy(t.direction),e.node=null,e.level=H(F,e.panoSize)}updateSweepLoadHistory(e){const t=this.persistentStorage.getArray("updateSweepLoadHistory:tempHistory");t.length=0;for(const i of this.sweepLoadHistory)i&&(!e||e&&e!==i)&&t.push(i);this.sweepLoadHistory.length=0,e&&this.sweepLoadHistory.push(e),this.sweepLoadHistory.push(...t)}onPanoRendered(e,t){var i,o;const s=this.panoLoadResolvers[e],r=this.activeRenderTargetDescriptors[e];r&&r.object&&(null===(o=(i=this.panoLoadMinimumCallbacks)[e])||void 0===o||o.call(i),delete this.panoLoadMinimumCallbacks[e],s())}getRenderTargetDescriptorForSweep(e){return this.activeRenderTargetDescriptors[e]}isRenderTargetDescriptorValid(e){return!!e&&!!e.object}isSweepZoomed(e){return!!Array.from(this.currentState.values()).find((t=>t.zoomingActive&&t.zoomSweepId===e))}getTileTrees(e){const t=this.tileTrees[e];if(!t)throw new Y("TiledPanoRenderer.getTileTrees() -> Tree array not yet initialized!");return t}checkTileTreeInitialized(e){return!!this.tileTrees[e]}getTileTree(e,t){const i=this.getTileTrees(e)[t];if(!i)throw new Y("TiledPanoRenderer.getTileTree() -> Tree not yet initialized!");return i}deleteTileTrees(e){const t=this.getTileTrees(e);for(let e=0;e<6;e++){const i=t[e];i&&i.deleteAllNodes()}this.tileTrees[e]=null,delete this.tileTrees[e]}clearTileState(e,t=!1,i=!1){const o=(e,o,s,r)=>{var n,a;i&&(null===(a=null===(n=o.extra.tile.image)||void 0===n?void 0:n.close)||void 0===a||a.call(n),o.extra.tile.image=null),t&&(o.extra.tile.uploaded=!1,o.extra.tile.downloaded=!1,o.extra.tile.zoomUploaded=!1,o.extra.tile.uploadAttempted=!1)};for(let t=0;t<6;t++){const i=this.getTileTree(e,t);i&&i.breadthFirst({callback:o.bind(this,t),maxLevel:H(F,this.panoQualityManager.getZoomPanoSize())})}}resetUploadState(e,t,i){const o=(e,o,s,r)=>{o.extra.tile.zoomUploaded=!i&&o.extra.tile.zoomUploaded,o.extra.tile.uploaded=!t&&o.extra.tile.uploaded};for(let t=0;t<6;t++){this.getTileTree(e,t).breadthFirst({callback:o.bind(this,t),minLevel:0})}}anyUploaded(e){if(!e)return!1;if(e.extra.tile&&this.isTileUploaded(e.extra.tile))return!0;if(e.children)for(const t of e.children)if(this.anyUploaded(t))return!0;return!1}getTileDirectoryEntry(e,t,i,o,s){let r=this.tileDirectory[e];r||(r={},this.tileDirectory[e]=r);const n=16384*t+1024*i+o;let a=r[n];return a||(a={cameraId:s,downloaded:!1,uploaded:!1,uploadAttempted:!1,zoomUploaded:!1,uploadQueued:!1,image:null,panoSize:-1,tileX:-1,tileY:-1,totalTiles:-1,tileIndex:o,faceTileIndex:-1,face:t,cubeFace:-1,sweepId:e,tileSize:-1,direction:new h.Vector3,node:null,level:i},r[n]=a),a._tileKey=n,a.cameraId=s,a}deleteTileDirectoryEntries(e){var t,i;const o=this.tileDirectory[e];if(o)for(const e of Object.values(o))e.image&&(null===(i=(t=e.image).close)||void 0===i||i.call(t),e.image=null);delete this.tileDirectory[e]}isTileUploaded(e){return this.isSweepZoomed(e.sweepId)?e.zoomUploaded:e.uploaded}setUploaded(e,t){this.isSweepZoomed(e.sweepId)?e.zoomUploaded=t:e.uploaded=t}queueUploadForTile(e,t,i,o){const s=!e.downloaded||e.uploadQueued&&!o||this.isTileUploaded(e)||e.panoSize>this.panoQualityManager.getNavPanoSize()&&!i.zoomingActive,r=this.getRenderTargetDescriptorForSweep(e.sweepId);if(s||!r||!this.isRenderTargetDescriptorValid(r))return;const n=this.cameraModule.cameraData.id,a=this.getCurrentState(n);o?this.uploadTile(e,i):(0===H(F,e.panoSize)?this.tileUploadQueue.addToForceQueue(e):t&&a.direction?this.tileUploadQueue.insertSortedIntoPanoQueue(n,e,r.extra.sweep,a.direction):this.tileUploadQueue.addToPanoQueue(e.sweepId,e),e.uploadQueued=!0)}uploadTile(e,t){const i=this.tileUploadQueue.getPanoLODDescriptor(e.sweepId,e.panoSize),o=this.getRenderTargetDescriptorForSweep(e.sweepId);if(!o||!e.image||!this.isRenderTargetDescriptorValid(o))return;let s=o.object,r=o.extra.size;if(this.isSweepZoomed(e.sweepId)&&(s=t.zoomRenderTarget,r=this.panoQualityManager.getZoomPanoSize()),this.isTileUploaded(e)||this.anyUploaded(e.node))this.setUploaded(e,!1);else{const t=e.tileX*e.tileSize,o=e.tileY*e.tileSize,n=e.tileSize/e.panoSize*r,l=t/e.panoSize*r,u=o/e.panoSize*r;let d=this.tempTileTextures.get(e.tileSize);d||(d=this.cwfRenderer.initSizedTexture2D(e.tileSize,{generateMipmaps:!1,minFilter:h.LinearFilter,flipY:!1}),this.tempTileTextures.set(e.tileSize,d)),this.cwfRenderer.uploadTexture2D(e.image,d,0,0),this.cwfRenderer.renderToCubeMap(d,s,e.tileSize,e.tileSize,0,0,e.tileSize,e.tileSize,l,u,n,n,e.cubeFace),a.W0.overlayStyle>0&&this.cwfRenderer.renderToCubeMap(this.overlayTiles[e.panoSize],s,e.tileSize,e.tileSize,0,0,e.tileSize,e.tileSize,l,u,n,n,e.cubeFace,h.NormalBlending,!0,.5),i.uploadCount++,this.setUploaded(e,!0)}e.uploadAttempted||i.uploadAttempts++,e.uploadAttempted=!0,i.uploadAttempts===e.totalTiles&&this.onPanoRendered(e.sweepId,e.panoSize)}updateUploadQueueProcessing(){if(!this.currentUploadPromise&&(this.overlayTilesLoaded||!this.usingTileOverlay)){const e=new m.m("pano/tiling/upload",(()=>this.engine.after(l.R.End).then((()=>this.processUploadQueue(this.tilingSettings.highResUploadsPerFrame,this.tilingSettings.uploadsPerFrame)))),$);this.currentUploadPromise=this.engine.commandBinder.issueCommand(e).then((async e=>{await e.promise,this.currentUploadPromise=null}))}}processUploadQueue(e=1,t){let i=0,o=0,s=null;const r=this.activeSweeps.map((e=>e.sweep));for(;s=this.tileUploadQueue.getNextFromUploadQueue(r);){const r=this.getRenderTargetDescriptorForSweep(s.sweepId),n=this.getCurrentState(s.cameraId);if(!(s.panoSize>this.panoQualityManager.getNavPanoSize()&&!n.zoomingActive||!this.isRenderTargetDescriptorValid(r))&&(this.uploadTile(s,n),i+=0!==s.level?1:0,o+=0===s.level?1:0,o>=t||i>=e))break}}loadOverlayTiles(){if(0!==a.W0.overlayStyle){let e=0;const t=[],o=(i,o,s)=>{const r=i[o]=this.cwfRenderer.initSizedTexture2D(F,{generateMipmaps:!1,minFilter:h.LinearFilter,flipY:!1});this.cwfRenderer.uploadTexture2D(s,r,0,0),e++,e>=t.length&&(this.overlayTilesLoaded=!0)};switch(a.W0.overlayStyle){case 1:t.push([i(880),this.overlayTiles,256]),t.push([i(9135),this.overlayTiles,512]),t.push([i(29274),this.overlayTiles,1024]),t.push([i(62717),this.overlayTiles,2048]),t.push([i(23169),this.overlayTiles,4096]);break;case 2:t.push([i(81960),this.overlayTiles,256]),t.push([i(89511),this.overlayTiles,512]),t.push([i(51106),this.overlayTiles,1024]),t.push([i(33909),this.overlayTiles,2048]),t.push([i(76486),this.overlayTiles,4096]);break;case 3:t.push([i(13106),this.overlayTiles,256]),t.push([i(4205),this.overlayTiles,512]),t.push([i(56252),this.overlayTiles,1024]),t.push([i(13103),this.overlayTiles,2048]),t.push([i(53384),this.overlayTiles,4096])}t.forEach((e=>{const t=document.createElement("img");t.crossOrigin="anonymous",t.src=e[0],t.onload=()=>{o.call(this,e[1],e[2],t)}})),this.usingTileOverlay=!0}else this.usingTileOverlay=!1}copyTargetToZoom(e,t){if(!t.zoomingActive)return;const i=this.getRenderTargetDescriptorForSweep(e);if(!i)throw new Y("Error in copying a null render target to a zoomed target");const o=i.object;this.cwfRenderer.copyCubemap(o.texture,t.zoomRenderTarget),this.copyBaseRenderStatusToZoomed(e)}setupZoomRenderTarget(e){if(this.panoQualityManager.getZoomPanoSize()>=this.panoQualityManager.getNavPanoSize()){if(e.zoomRenderTarget&&e.zoomRenderTarget.width===this.panoQualityManager.getZoomPanoSize())return;const t=e.zoomRenderTarget;e.zoomRenderTarget=this.cwfRenderer.initRenderTargetCube(this.panoQualityManager.getZoomPanoSize()),t&&(this.cwfRenderer.copyCubemap(t.texture,e.zoomRenderTarget),t.texture.dispose(),t.texture.version=0,t.texture=null),e.zoomSweepRenderingDisabled=!1}else e.zoomSweepRenderingDisabled=!0}getCurrentState(e=this.cameraModule.cameraData.id){var t;const i=null!==(t=this.currentState.get(e))&&void 0!==t?t:ee;if(!i)throw new Error(`No state for camera with id ${e}!`);return i}}class J{constructor(){this.direction=new h.Vector3,this.position=new h.Vector3,this.rotation=new h.Quaternion,this.sweepId=void 0,this.zoomSweepRenderingDisabled=!1,this.zoomingActive=!1,this.zoomSweepId=null}}const ee=new J;var te,ie=i(97994),oe=i(27200);!function(e){e[e.None=0]="None",e[e.Queued=1]="Queued",e[e.ForceQueued=2]="ForceQueued",e[e.Downloading=3]="Downloading",e[e.Downloaded=4]="Downloaded",e[e.DownloadFailed=5]="DownloadFailed"}(te||(te={}));const se=te;var re,ne=i(52026),ae=i(66806),le=i(78229),ue=i(96659);!function(e){e[e.CurrentView=0]="CurrentView",e[e.FullPanorama=1]="FullPanorama"}(re||(re={}));var he;!function(e){e[e.None=0]="None",e[e.DirectionalFOV=1]="DirectionalFOV"}(he||(he={}));class de{getQualityQueueSize(e,t){return e===re.CurrentView?this.currViewQueue[t].value:this.fullPanoQueue[t].value}makeQueueSubscription(e,t,i){return(e===re.CurrentView?this.currViewQueue[t]:this.fullPanoQueue[t]).onChanged(i)}constructor(e,t,i){this.panoQualityManager=e,this.tilingSettings=t,this.sweepData=i,this.tempQueue=[],this.priorityCriteria=new Map,this.filterAndPrioritize=(e,t,i=this.priorityCriteria)=>{const o=this.tempQueue;o.length=0;const s=Array.from(i.values()).sort(((e,t)=>t.priority-e.priority));for(const e of s)e.sweep&&this.queueTilesForPano(o,t,e.sweep,w.c5.BASE,e.id);const r=fe(e,o,!0);this.currViewQueue[w.MF.BASE].value=r,this.fullPanoQueue[w.MF.BASE].value=r;const n=s.filter((i=>{if(!i.sweep)return!0;return!(void 0!==i.upcomingSweeps&&null!==i.upcomingSweeps)||(this.queueForRestrictedSweeps(i,e,t),!1)}));this.queueForPanoViewmode(n,e,t),this.queueForNonPanoViewmode(n,e,t);for(const i of s)this.tilingSettings.downloadFullPano&&this.queueFullPano(i,e,t)},this.queueRaycast=(()=>{const e=new h.Vector3;return(t,i,o)=>{if(t.sweep)if(t.hovered)this.queueTilesForPano(i,o,t.hovered,w.c5.BASE,t.id);else if(t.hit){const s=e.copy(t.hit.point).sub(t.sweep.position),r=this.getSinglePanoInDirection(t,s),n=this.sweepData.getSweep(r);n&&this.queueTilesForPano(i,o,n,w.c5.BASE,t.id)}}})(),this.queueScoredSweeps=(e,t,i)=>{if(e.sweep&&e.maxResolution<=2048){const o=this.persistentStorage.getArray("filterAndPrioritize:scoredSweeps");this.populateScoredSweeps(e.sweep,o,e.direction,6),this.queueTilesForPanos(t,o,i,w.c5.BASE,e.id,4)}},this.queueFOVStandardNarrow=(e,t,i)=>{if(!e.sweep)return;const o=this.tempQueue;o.length=0;const{direction:s,fov:r,sweep:n}=e,a=this.queueFOVTiles(e,o,w.MF.STANDARD,r,i);this.sortTiles(o,n,s),fe(t,o),this.currViewQueue[w.MF.STANDARD].value=a,this.fullPanoQueue[w.MF.STANDARD].value=a},this.queueFOVHighNarrow=(e,t,i)=>{if(!e.sweep)return;const o=this.tempQueue;o.length=0;const{fov:s,sweep:r,direction:n}=e,a=this.queueFOVTiles(e,o,w.MF.HIGH,s,i),l=this.queueFOVTiles(e,o,w.MF.ULTRAHIGH,s,i);this.sortTiles(o,r,n),fe(t,o),this.currViewQueue[w.MF.HIGH].value=a,this.currViewQueue[w.MF.ULTRAHIGH].value=l},this.queueWASD=(e,t,i)=>{const o=this.persistentStorage.getArray("filterAndPrioritize:neighbors")||[];if(o.length=0,!e.sweep)return;const s=[y.B1.FORWARD,y.B1.RIGHT,y.B1.LEFT,y.B1.BACK];for(const t of s){const i=this.getSweepIdInLocalDirection(e,t),s=this.sweepData.getSweep(i);s&&o.push(s)}this.queueTilesForPanos(t,o,i,w.c5.BASE,e.id)},this.getSweepIdInLocalDirection=(()=>{const e=new h.Vector3;return(t,i)=>{const o=t.rotation,s=e.copy(i).applyQuaternion(o);return this.getSinglePanoInDirection(t,s)}})(),this.persistentStorage=new v,this.currViewQueue=ge(),this.fullPanoQueue=ge(),this.isMobileDevice=(0,oe.Fr)()}createCriteria(e){const t=new me(e);t.maxResolution=this.panoQualityManager.getNavPanoSize(),this.priorityCriteria.set(e,t)}removeCritera(e){this.priorityCriteria.delete(e)}updateCriteria(e,t,i,o,s,r,n){const a=this.getCriteria(e);a.sweep=i,a.priority=t,a.position.copy(o),a.direction.copy(s),a.rotation.copy(r),a.hit=n}setHoveredSweep(e,t){this.getCriteria(e).hovered=null!=t?t:null}setUpcomingSweeps(e){for(const t of this.priorityCriteria.values())t.upcomingSweeps=e}getUpcomingSweeps(){for(const e of this.priorityCriteria.values())return e.upcomingSweeps}clearUpcomingSweeps(){for(const e of this.priorityCriteria.values())e.upcomingSweeps=void 0}setDownloadFOV(e,t){this.getCriteria(e).fov=t}updateAllViewmodes(e){for(const t of this.priorityCriteria.values())t.viewmode=e}updateMaxResolutionForCriteria(e,t){const i=this.getCriteria(e);i.maxResolution!==t&&u.Vy.for(this).debug(`Setting max resolution: ${t} for camera: ${e}`),i.maxResolution=t}queueForRestrictedSweeps(e,t,i){if(!e.upcomingSweeps)return;let o=0;for(const s of e.upcomingSweeps)if(o++,this.queueTilesForPano(t,i,s,w.c5.BASE,e.id),o>=3)break;this.queueFOVStandardNarrow(e,t,i),this.queueFOVHighNarrow(e,t,i)}queueForPanoViewmode(e,t,i){const o=[this.queueRaycast,this.queueFOVStandardNarrow,this.queueScoredSweeps,this.queueFOVHighNarrow];this.isMobileDevice||o.push(this.queueWASD),this.iterateQueueFillersByCriteria(Array.from(e).filter((e=>e.viewmode===ae.N.Panorama)),o,t,i)}queueForNonPanoViewmode(e,t,i){let o=0;for(const s of e){if(!s.hit||!this.meshQuery||s.viewmode===ae.N.Panorama)continue;const e=(0,ne.I9)(this.sweepData,!1,s.hit.intersection,this.meshQuery),r=e.length>0?e[0].sweep:this.sweepData.getClosestSweep(s.hit.point,!0);r&&(o+=this.queueTilesForPano(t,i,r,w.c5.BASE,s.id))}return o}queueFOVTiles(e,t,i,o,s){if(!e.sweep)return 0;const r=w.oY[i];return this.canDownloadSize(e.sweep,i,e.maxResolution)?this.queueTilesInDirectionForPano(t,s,e.sweep,r,e.direction,o,e.id):0}queueFullPano(e,t,i){if(!e.sweep)return;const o=this.tempQueue;if(o.length=0,e.maxResolution<=w.c5.HIGH){if(this.canDownloadSize(e.sweep,w.MF.HIGH,e.maxResolution)){const t=this.queueTilesForPano(o,i,e.sweep,w.c5.HIGH,e.id);this.fullPanoQueue[w.MF.HIGH].value=t}}else if(this.canDownloadSize(e.sweep,w.MF.ULTRAHIGH,e.maxResolution)){const t=this.queueTilesForPano(o,i,e.sweep,w.c5.ULTRAHIGH,e.id);this.fullPanoQueue[w.MF.ULTRAHIGH].value=t}this.sortTiles(o,e.sweep,e.direction),fe(t,o,!0)}canDownloadSize(e,t,i){const o=w.oY[t],s=this.panoQualityManager.getNavPanoSize()>=o||i>=o&&this.panoQualityManager.getZoomPanoSize()>=o;return e.availableResolution(t)===t&&s}populateScoredSweeps(e,t,i,o){(t=t||[]).length=0;const s=(new h.Vector3).copy(e.position),r=[le.Ol(),le.AU(e),le.fm(s,400),le.jW(s,i,.75)],n=[ue.d$(s,a.W0.navigation.distanceFactor),ue.oW(s,i,a.W0.navigation.directionFactor)],l=this.sweepData.getSweepNeighbours(e),u=this.sweepData.sortByScore(r,n,l);for(let e=0;e<u.length&&e<o;e++){const i=u[e].sweep;t.push(i)}}queueTilesForPanos(e,t,i,o,s,r){let n=0;for(const a of t){if(n+=this.queueTilesForPano(e,i,a,o,s)>0?1:0,r&&n>=r)break}return n}queueTilesForPano(e,t,i,o,s){const r=this.persistentStorage.get("queueTilesForSweep:filterCriteria",(()=>({filter:he.None})));return this.filterAndQueueTileDownloadDescriptors(e,t,i,o,r,s)}queueTilesInDirectionForPano(e,t,i,o,s,r,n){const a=this.persistentStorage.get("queueTilesInDirectionForSweep:panoSpaceDir",(()=>new h.Vector3)),l=this.persistentStorage.get("queueTilesInDirectionForSweep:filterCriteria",(()=>({filter:he.DirectionalFOV,direction:new h.Vector3,fov:60})));return a.copy(s),I(i.rotation,a),l.direction.copy(a),l.fov=r,this.filterAndQueueTileDownloadDescriptors(e,t,i,o,l,n)}filterAndQueueTileDownloadDescriptors(e,t,i,o,s,r){const n=this.persistentStorage.getArray("filterAndQueueTileDownloadDescriptors:descriptors"),a=t.getTileDownloadDescriptors(i,o,r);n.length=0,this.filterTileDownloadDescriptors(a,n,s);let l=0;for(const t of n)t&&(e.push(t),l++);return l}filterTileDownloadDescriptors(e,t,i){let o,s;if(i.filter===he.DirectionalFOV)for(o=0;o<e.length;o++)s=e[o],s&&_(s.panoSize,s.tileSize,s.face,s.tileX,s.tileY,i.direction,i.fov)&&t.push(s);else for(o=0;o<e.length;o++)s=e[o],t.push(s);for(o=0;o<t.length;o++)s=t[o],s&&!this.canIncludeDescriptor(s)&&(t[o]=null)}canIncludeDescriptor(e){return e.status!==se.Downloading&&e.status!==se.Downloaded}sortTiles(e,t,i){ce.panoSpaceDir.copy(i),I(t.rotation,ce.panoSpaceDir);const o=Array.from(this.priorityCriteria.values()).reduce(((e,t)=>Math.min(e,t.fov)),360);ce.fovThresholdNarrow=we(o),e.sort(pe)}insertSortedPanoTile(e,t,i,o,s){ce.panoSpaceDir.copy(s),I(o.rotation,ce.panoSpaceDir);const r=this.getCriteria(e);ce.fovThresholdNarrow=we(r.fov);let n=-1;for(let e=0;e<t.length;e++){if(pe(i,t[e])<=0){n=e;break}}if(-1===n)t[t.length]=i;else{for(let e=t.length;e>n;e--)t[e]=t[e-1];t[n]=i}}clonePriorityCriteria(){const e=new Map;for(const t of this.priorityCriteria.keys())e.set(t,this.getCriteria(t).clone());return e}getSinglePanoInDirection(e,t){const i=e.sweep;if(!i)return"";const o=[le.AU(i),le.Ol(),le.jW(i.position,t)],s=[ue.oW(i.position,t),ue.Io(i.position)],r=i.neighbours.filter((e=>{const t=this.sweepData.getSweep(e);return o.every((e=>e(t)))})).map((e=>{const t=this.sweepData.getSweep(e);return{sweepId:e,score:s.reduce(((e,i)=>e+i(t)),0)}})),n=r.reduce(((e,t)=>e.score>t.score?e:t),r[0]);return n?n.sweepId:""}getCriteria(e){const t=this.priorityCriteria.get(e);if(!t)throw new Error("No criteria for id!");return t}iterateQueueFillersByCriteria(e,t,i,o){for(const s of t)for(const t of e)s(t,i,o)}}const ce={panoSpaceDir:new h.Vector3,fovThresholdNarrow:-1},pe=(e,t)=>{const i=ce.panoSpaceDir,o=ce.fovThresholdNarrow,s=Math.max(Math.min(i.dot(e.direction),1),-1),r=Math.max(Math.min(i.dot(t.direction),1),-1);return s>=o&&r<o?-1:s<o&&r>=o||e.panoSize>t.panoSize?1:t.panoSize>e.panoSize?-1:-(s-r)};function ge(){return{[w.MF.BASE]:(0,ie.p)(0),[w.MF.STANDARD]:(0,ie.p)(0),[w.MF.HIGH]:(0,ie.p)(0),[w.MF.ULTRAHIGH]:(0,ie.p)(0)}}function we(e){return Math.cos(Math.PI/180*(e/2))}function fe(e,t,i=!1){let o=0;if(e&&t)for(const s of t)i&&-1!==e.indexOf(s)||(e.push(s),o++);return o}class me{constructor(e){this.id="",this.priority=0,this.direction=new h.Vector3,this.position=new h.Vector3,this.rotation=new h.Quaternion,this.hovered=null,this.sweep=null,this.viewmode=null,this.fov=120,this.hit=null,this.id=e}set({id:e,direction:t,fov:i,hovered:o,position:s,rotation:r,sweep:n,upcomingSweeps:a,viewmode:l,hit:u,priority:h,maxResolution:d}){return this.id=void 0===e?this.id:e,this.direction.copy(void 0===t?this.direction:t),this.position.copy(void 0===s?this.position:s),this.rotation.copy(void 0===r?this.rotation:r),this.hovered=void 0===o?this.hovered:o,this.sweep=void 0===n?this.sweep:n,this.upcomingSweeps=a,this.viewmode=void 0===l?this.viewmode:l,this.fov=void 0===i?this.fov:i,this.hit=void 0===u?this.hit:u,this.priority=void 0===h?this.priority:h,this.maxResolution=void 0===d?this.maxResolution:d,this}clone(){const e=new me(this.id);return e.set(this),e}}var Te=i(97084),Se=i(5544);const ve=new u.Vy("tile-downloader");class De{constructor(e,t,i,o){this.sweepData=e,this.api=t,this.tilePrioritizer=i,this.settings=o,this.persistentStorage=new v,this.downloadDescriptors={},this.priorityQueue=[],this.forceQueue=[],this.activeDownloads=[],this.lastPrioritizedTime=Date.now(),this.processPriorityQueue=!0}init(){}render(){this.update()}update(){this.processQueue(this.forceQueue,!1),this.processPriorityQueue&&(!this.processQueuePromise&&this.activeDownloads.length<this.settings.concurrentDownloads&&Date.now()-this.lastPrioritizedTime>200&&(this.processQueuePromise=this.engine.commandBinder.issueCommand(new m.m("pano/tiling/queue-download",(()=>{this.queuePrioritizedTiles(),this.lastPrioritizedTime=Date.now()}),100)).then((async e=>{await e.promise,this.processQueuePromise=null}))),this.processQueue(this.priorityQueue,!1))}dispose(){}activate(e){this.engine=e}deactivate(e){}setRestrictedSweeps(e){const t=e.map((e=>this.sweepData.getSweep(e)));this.tilePrioritizer.setUpcomingSweeps(t),this.clearFromAllQueuesBySweep(e)}clearRestrictedSweeps(){this.tilePrioritizer.clearUpcomingSweeps()}setLoadCallbacks(e,t){this.onTileDownloaded=e,this.onPanoDownloaded=t}getNonDownloadedTiles(e,t,i,o){i.length=0;const s=this.getTileDownloadDescriptors(e,t,o);for(const e of s)!e||e.status!==se.None&&e.status!==se.Queued||i.push(e)}forceQueueTiles(e,t,i,o,s){const r=this.persistentStorage.getArray("forceQueueTiles:remaining"),n=this.persistentStorage.getArray("forceQueueTiles:matching"),a=this.persistentStorage.getArray("forceQueueTiles:toDownload");if(this.getNonDownloadedTiles(e,t,r,s),a.length=0,r.length>0){this.tilePrioritizer.sortTiles(r,e,i),n.length=0,E(e,t,i,n,!0);for(const e of r)for(const t of n)e.face===t.face&&e.faceTileIndex===t.faceTileIndex&&a.push(e);this.forceQueue.push(...a),this.setStatusForAllDescriptors(this.forceQueue,se.ForceQueued),this.clearFromQueue(this.priorityQueue,se.ForceQueued,!1),o&&this.processQueue(this.forceQueue,!0)}}clearForceQueue(){this.clearQueue(this.forceQueue)}queuePrioritizedTiles(){this.clearQueue(this.priorityQueue),this.tilePrioritizer.filterAndPrioritize(this.priorityQueue,this),this.invalidateDuplicateEntries(this.priorityQueue),this.clearFromQueue(this.priorityQueue,se.None,!0),this.setStatusForAllDescriptors(this.priorityQueue,se.Queued),this.lastPrioritizedTime=Date.now()}clearQueue(e){this.setStatusForAllDescriptors(e,se.None),e.length=0}clearFromQueue(e,t,i){for(let o=0;o<e.length;o++){const s=e[o];s&&(t===s.status&&!i||t!==s.status&&i)&&(e[o]=null)}}clearFromAllQueuesBySweep(e){this.clearFromQueueBySweep(this.forceQueue,e),this.clearFromQueueBySweep(this.priorityQueue,e)}clearFromQueueBySweep(e,t){const i=(0,T.Z)(t);for(let t=0;t<e.length;t++){const o=e[t];o&&o.sweep&&(i[o.sweep.id]||(e[t]=null))}}setStatusForAllDescriptors(e,t){for(const i of e)i&&(i.status=t)}invalidateDuplicateEntries(e){for(const t of e)t&&(t.queuedCount=0);for(let t=0;t<e.length;t++){const i=e[t];i&&(i.queuedCount++,i.queuedCount>1&&(e[t]=null))}}getTileDownloadDescriptors(e,t,i){const o=this.getAllTileDownloadDescriptors(e.id);let s=o[t];return s||(s=this.buildDownloadDescriptorArray(t),o[t]=s,this.initTileDownloadDescriptors(s,e,t)),void 0!==i&&s.forEach((e=>{e&&(e.criteriaId=i)})),s}getAllTileDownloadDescriptors(e){let t=this.downloadDescriptors[e];return t||(t={},this.downloadDescriptors[e]=t),t}deleteAllTileDownloadDescriptors(e){this.downloadDescriptors[e]=null,delete this.downloadDescriptors[e]}processQueue(e,t){if(this.cleanupActiveDownloads(),this.activeDownloads.length<this.settings.concurrentDownloads||t){const i=t?e.length:this.settings.concurrentDownloads-this.activeDownloads.length;let o=0;for(let t=0;o<i&&e.length>0;t++){const t=e.shift();t&&(this.startDownload(t),o++)}}}async startDownload(e){if(e.sweep){const t=e.status===se.ForceQueued?Te.QK.HIGHEST:Te.QK.MEDIUM;e.status=se.Downloading;this.checkRestrictedSweep(e.sweep.id)||ve.warn("Downloading a tile that is not in restricted list"),this.activeDownloads.push(e);const i=await this.getTileUrl(e.sweep,e.panoSize,e.tileSize,e.tileIndex);this.api.getImageBitmap(i,e.tileSize,e.tileSize,{maxRetries:3,priority:t}).then(this.downloadComplete.bind(this,e),this.downloadFailed.bind(this,e))}}checkRestrictedSweep(e){const t=this.tilePrioritizer.getUpcomingSweeps();if(t){let i=!1;for(const o of t)o&&o.id===e&&(i=!0);return i}return!0}downloadFailed(e,t){e.status=se.DownloadFailed}downloadComplete(e,t){if(e.sweep&&(e.status=se.Downloaded,e.image=t,this.onTileDownloaded&&this.onTileDownloaded(e),this.engine.broadcast(new Se.f),this.isPanoDownloaded(e.sweep,e.panoSize))){const t={sweep:e.sweep,tileSize:e.tileSize,panoSize:e.panoSize};this.onPanoDownloaded&&this.onPanoDownloaded(t)}}cleanupActiveDownloads(){const e=this.persistentStorage.getArray("cleanupActiveDownloads:temp");e.length=0;for(const t of this.activeDownloads)t.status!==se.Downloaded&&t.status!==se.DownloadFailed&&e.push(t);this.activeDownloads.length=0,this.activeDownloads.push(...e)}isPanoDownloaded(e,t){const i=this.getTileDownloadDescriptors(e,t);if(!i||i.length<=0)return!1;for(const e of i)if(e&&e.status!==se.Downloaded)return!1;return!0}buildDownloadDescriptorArray(e){const t=b(e),i=[];for(let e=0;e<t;e++){const e=this.buildDownloadDescriptor();i.push(e)}return i}buildDownloadDescriptor(){return{criteriaId:null,sweep:null,panoSize:-1,tileSize:-1,tileIndex:-1,totalTiles:-1,faceTileIndex:-1,status:se.None,image:null,direction:new h.Vector3,face:-1,cubeFace:-1,tileX:-1,tileY:-1,queuedCount:-1}}initTileDownloadDescriptors(e,t,i){for(let o=0;o<e.length;o++){const s=e[o];s&&this.initTileDownloadDescriptor(s,t,i,o)}}initTileDownloadDescriptor(e,t,i,o){const s=i>=F?F:i;e.face=x(i,o),e.cubeFace=g(e.face),e.sweep=t,e.panoSize=i,e.tileSize=s,e.tileIndex=o,e.totalTiles=b(i),e.status=se.None,e.image=null,M(e.panoSize,e.tileIndex,e),U(e.panoSize,e.tileSize,e.cubeFace,e.tileX,e.tileY,Q.Center,0,e.direction)}getTileUrl(e,t,i,o){const s=this.persistentStorage.get("getTileUrl:locationInfo",(()=>({face:-1,faceTileIndex:-1,tileX:-1,tileY:-1})));M(t,o,s);const r=Math.floor(t/i),n=r*r,a=Math.floor(o/n),l=R.A.getPanoSizeClass(t);return e.getTileUrl(l,a,s.tileX,s.tileY)}}var Pe=i(35898),ye=i(4582),ze=i(5243),Re=i(25443),Qe=i(12837),Ae=i(18855),Fe=i(31285),Ue=i(45862),xe=i(70046),Me=i(97171),be=i(79388),Ie=i(10574);class Ee extends o.n{constructor(){super(...arguments),this.name="sweep-pano-tiling",this.enum={resolution:w.MF,queueStyle:re},this.preloadQuality=null,this.preloadResolution=null,this.handleResolutionChange=e=>{const t=this.panoRenderer.getCurrentPanoResolution();this.qualityManager.update({height:this.getVerticalResolution()});t!==this.panoRenderer.getCurrentPanoResolution()&&e&&this.resetPano(e)}}setPreloadQuality(e){this.settingsData.setSetting(a.Oe,e)}async init(e,t){const{market:i}=t,[o,r,l]=await Promise.all([t.getModuleBySymbol(n.qL),t.getModuleBySymbol(n.M7),i.waitForData(ze.$)]);[this.settingsData,this.sweepData,this.cameraModule]=await Promise.all([i.waitForData(Re.o),i.waitForData(Qe.A),t.getModuleBySymbol(n.jh)]);const u=this.cwfRenderer=r.cwfRenderer,h=r.maxCubemapSize,{navPanoSize:d,zoomPanoSize:c}=function(e){let t=w.c5.STANDARD,i=w.c5.HIGH;return(0,oe.Fr)()?(0,oe.Fr)()&&e&&(t=w.c5.STANDARD,i=w.c5.HIGH):(t=w.c5.HIGH,i=w.c5.ULTRAHIGH),{navPanoSize:t,zoomPanoSize:i}}(r.isHighPerformanceMobileGPU());this.settings=new a.RB,this.qualityManager=new R.A(h,d,c,this.getVerticalResolution()),this.tilePrioritizer=new de(this.qualityManager,this.settings,this.sweepData),t.getModuleBySymbol(n.PM).then((e=>this.tilePrioritizer.meshQuery=e)),this.tileDownloader=new De(this.sweepData,o.getApi(),this.tilePrioritizer,this.settings),this.panoRenderer=new K(u,this.qualityManager,this.tileDownloader,this.tilePrioritizer,this.sweepData,this.cameraModule,l,this.settings),this.tileDownloader.setLoadCallbacks(this.panoRenderer.onTileDownLoaded),t.addComponent(this,this.tileDownloader),t.addComponent(this,this.panoRenderer),this.bindings.push(t.commandBinder.addBinding(Ie.V,(async({navSize:e})=>{this.overrideNavPanoResolutionMax(e)}))),this.bindings.push(t.subscribe(Fe.A,(e=>{this.setTilingFOV()})),t.subscribe(s.h,(()=>{this.setTilingFOV(),this.handleResolutionChange(this.sweepData.state.currentSweep)})),t.subscribe(be.lo,(()=>{this.setTilingFOV(),this.handleResolutionChange(this.sweepData.state.currentSweep)})),t.subscribe(Pe.A,(e=>{this.tileDownloader.setRestrictedSweeps(e.sweepIds)})),t.subscribe(ye.A,(e=>{this.tileDownloader.clearRestrictedSweeps()})),t.subscribe(Ae.n,(e=>{const t=this.sweepData.getSweep(e.sweepId);this.setHoverPreloadSweep(e.hovered?t:void 0)})),t.subscribe(Ue.Y,(e=>{this.tilePrioritizer.updateAllViewmodes(e.toMode)})),this.sweepData.state.transition.onPropertyChanged("active",(()=>{if(this.sweepData.state.transition.to){const e=this.sweepData.getSweep(this.sweepData.state.transition.to);this.handlePreloadQualityChange(e),this.enableHighRes(!1)}})),this.settingsData.onSettingChanged(a.Oe,(()=>{if(this.preloadQuality=this.settingsData.tryGetSetting(a.Oe,null),this.qualityManager.overrideWindowMaximums(null!==this.preloadQuality),this.sweepData.currentSweepObject){const e=this.sweepData.currentSweepObject;this.handlePreloadQualityChange(e),this.preloadQuality===w.MF.ULTRAHIGH&&this.panoRenderer.enableUltraHighQualityMode(e.id);const t=this.preloadQuality===w.MF.HIGH||this.preloadQuality===w.MF.ULTRAHIGH;this.enableHighRes(t,e.id),this.resetPano(e.id)}})),t.subscribe(be.ul,(()=>{this.panoRenderer.deactivate()})),t.subscribe(be.aF,(()=>{this.panoRenderer.activate(t)}))),this.setTilingFOV(),t.broadcast(new xe.sb(Me.D.PanoTiles))}getVerticalResolution(){return this.cwfRenderer.getSize().height*this.cwfRenderer.getPixelRatio()}overrideNavPanoResolutionMax(e){const t=w.oY[null!=e?e:this.panoRenderer.getCurrentPanoResolution()],i=null!==this.settingsData.tryGetSetting(a.Oe,null);this.qualityManager.overrideWindowMaximums(i),this.qualityManager.overrideNavPanoSize(t)}setTilingFOV(){for(const e of this.cameraModule.cameraDatas.values){const t=e.fovX(),i=e.fovY(),o=Math.max(t,i)*A.tm;this.tilePrioritizer.setDownloadFOV(e.id,o)}}getRenderer(){return this.panoRenderer}setHoverPreloadSweep(e){this.tilePrioritizer&&this.tilePrioritizer.setHoveredSweep(this.cameraModule.cameraData.id,e)}handlePreloadQualityChange(e){if(null!==this.preloadQuality){const t=e.availableResolution(this.preloadQuality);this.preloadResolution=R.A.getPanoSize(t)}else this.preloadResolution=null}enableHighRes(e=!0,t){const i=null!==this.preloadResolution?this.preloadResolution:e?this.qualityManager.getZoomPanoSize():this.qualityManager.getNavPanoSize();this.tilePrioritizer.updateMaxResolutionForCriteria(this.cameraModule.cameraData.id,i),this.panoRenderer.highResRenderTarget(e,t)}enableZooming(e,t){if(e){const e=R.A.getPanoSizeClass(this.qualityManager.getZoomPanoSize());return this.requestResolution({sweepId:t,resolution:e}).res>=e}return this.enableHighRes(!1,t),this.resetPano(t),!1}requestResolution({onProgress:e,queueType:t=re.CurrentView,quickly:i=!1,resolution:o,sweepId:s,timeout:r=1e3}){const n=this.sweepData.getSweep(s);this.settings.highResUploadsPerFrame=i?a.W0.maxHighResUploadsPerFrame:a.W0.highResUploadsPerFrame,this.settings.concurrentDownloads=i?a.W0.maxConcurrentDownloads:a.W0.concurrentDownloads,this.settings.downloadFullPano=t===re.FullPanorama;const l=n.availableResolution(o),u=w.oY[l];u>w.c5.HIGH&&(this.qualityManager.overrideWindowMaximums(!0),this.panoRenderer.enableUltraHighQualityMode(n.id));(u>w.oY[this.panoRenderer.getCurrentPanoResolution()]||u>this.qualityManager.getNavPanoSize())&&(this.enableHighRes(!0,n.id),this.resetPano(n.id));const h=this.waitForQueue(t,o,r);return e&&h.progress(e),{res:l,promise:h.nativePromise()}}waitForQueue(e,t,i=1e3){const o=new r.i,s=()=>{l.cancel(),o.notify(1),o.resolve()};let n=this.tilePrioritizer.getQualityQueueSize(e,t),a=window.setTimeout((()=>{u.Vy.for(this).debug(`Download queue ${e} timed out from inactivity after ${i}ms`),s()}),i);const l=this.tilePrioritizer.makeQueueSubscription(e,t,(e=>{if(a&&(window.clearTimeout(a),a=0,n=e),e>0){const t=(n-e)/Math.max(n,1);o.notify(t)}else s()}));return o.promise()}resetSweep(e){this.enableHighRes(!1,e),this.resetPano(e),this.settings.reset()}resetPano(e){this.panoRenderer.resetRenderStatus(e,!1,!0,this.panoRenderer.panoQualityManager.getNavPanoSize()),this.panoRenderer.clearAllQueuedUploadsForPano(e),this.panoRenderer.renderPanoTiles(e,null,!1,!1)}async rerenderCurrentSweepPano(){var e;const t=null===(e=this.sweepData.currentSweepObject)||void 0===e?void 0:e.id;t&&(this.panoRenderer.deactivatePano(t),await this.panoRenderer.activateSweep(t),this.resetSweep(t))}}},5544:(e,t,i)=>{i.d(t,{f:()=>s});var o=i(7478);class s extends o.QB{constructor(){super()}}},4582:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(7478);class s extends o.QB{constructor(){super()}}},35898:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(7478);class s extends o.QB{constructor(e){super(),this.sweepIds=e}}},79388:(e,t,i)=>{i.d(t,{aF:()=>n,lo:()=>s,ul:()=>r});var o=i(7478);class s extends o.QB{constructor(e){super(),this.pixelRatio=e}}class r extends o.QB{constructor(e){super(),this.event=e}}class n extends o.QB{constructor(e){super(),this.event=e}}},31285:(e,t,i)=>{i.d(t,{A:()=>s});var o=i(7478);class s extends o.QB{constructor(e){super(),this.zoomLevel=e}}},73586:(e,t,i)=>{i.d(t,{i:()=>r});var o=i(76185),s=i(68920);class r{constructor(e){this.waitingGets=new Map,this.comparer=e||this.defaultComparer,this.poolArray=[]}add(e,t=!0){const i=this.createObjectDescriptor(e);return i.object=e,i.inUse=t,this.addObjectDescriptorToPool(i),i}get(e){for(const t of this.poolArray)if(!t.inUse&&this.comparer(t,e))return t.inUse=!0,t;return null}async tryGetAndWait(e){const t=this.get(e);if(t)return Promise.resolve(t);{const t=e||"no-criteria";this.waitingGets.has(t)||this.waitingGets.set(t,[]);const i=this.waitingGets.get(t);(0,o.$)(i);const r=new s.i;return i.push(r),r.nativePromise()}}free(e){for(const t of this.poolArray)if(t.object===e){const e=this.isWaitingForObject(t);return e?e.resolve(t):t.inUse=!1,!0}return!1}isWaitingForObject(e){if(this.waitingGets.size>0)for(const[t,i]of this.waitingGets.entries())if(i.length>0){if("no-criteria"===t||this.comparer(e,t)){const e=i.shift();if(e)return e}}return null}all(){return this.poolArray}defaultComparer(e,t){return!0}createObjectDescriptor(e){return{object:e,inUse:!1}}addObjectDescriptorToPool(e){this.poolArray.push(e)}}},64713:(e,t,i)=>{i.d(t,{Z:()=>o});const o=(e=[])=>{const t={};for(const i of e)t[i]=!0;return t}},80783:(e,t,i)=>{i.d(t,{h:()=>s});var o=i(7478);class s extends o.QB{constructor(e,t){super(),this.width=e,this.height=t}}},29274:(e,t,i)=>{e.exports=i.p+"images/outlineBasic1024.png"},62717:(e,t,i)=>{e.exports=i.p+"images/outlineBasic2048.png"},880:(e,t,i)=>{e.exports=i.p+"images/outlineBasic256.png"},23169:(e,t,i)=>{e.exports=i.p+"images/outlineBasic4096.png"},9135:(e,t,i)=>{e.exports=i.p+"images/outlineBasic512.png"},51106:(e,t,i)=>{e.exports=i.p+"images/outlineEnhanced1024.png"},33909:(e,t,i)=>{e.exports=i.p+"images/outlineEnhanced2048.png"},81960:(e,t,i)=>{e.exports=i.p+"images/outlineEnhanced256.png"},76486:(e,t,i)=>{e.exports=i.p+"images/outlineEnhanced4096.png"},89511:(e,t,i)=>{e.exports=i.p+"images/outlineEnhanced512.png"},56252:(e,t,i)=>{e.exports=i.p+"images/outlineFilled1024.png"},13103:(e,t,i)=>{e.exports=i.p+"images/outlineFilled2048.png"},13106:(e,t,i)=>{e.exports=i.p+"images/outlineFilled256.png"},53384:(e,t,i)=>{e.exports=i.p+"images/outlineFilled4096.png"},4205:(e,t,i)=>{e.exports=i.p+"images/outlineFilled512.png"}}]);