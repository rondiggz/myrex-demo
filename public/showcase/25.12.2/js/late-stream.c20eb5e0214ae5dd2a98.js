/*! For license information please see late-stream.c20eb5e0214ae5dd2a98.js.LICENSE.txt */
"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[2276],{12850:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var i=n(15564),a=n(90082),r=n(32484),s=n(71687),o=n(8072);const{TEXTURE_SETTINGS:l,clearRaycastHits:d}=r.yJ;const u=async function(e){if(!o.DEBUG_TILEDMESH_SETTINGS.debug)return;const t=await e.getModuleBySymbol(a.ZF),n=await e.getModuleBySymbol(s.GR),r=t.addPanel(i.F.TITLE,i.F.HOTKEYS,{width:350});await t.loadPromise.then((()=>{const e="meshtextures";[{panel:r,header:e,setting:"disableTextureStreamBelowLod",initialValue:()=>-1,onChange:e=>{e>-1&&n.textureQualityMap.limitStreamingBelow(e)},urlParam:!0,rangePrecision:0,range:[-1,7]},{panel:r,header:e,setting:"textureStreamPause",initialValue:()=>l.debugPauseTexStream,onChange:e=>{l.debugPauseTexStream=e},urlParam:!0},{panel:r,header:e,setting:"textureStreamRaycastHits",initialValue:()=>l.debugLOD,onChange:e=>{l.debugLOD=e,e||d()},urlParam:!0},{panel:r,header:e,setting:"debugRTTQuality",initialValue:()=>l.debugRttQuality,onChange:e=>{l.debugRttQuality=e,e||n.setMeshOverlay({})},urlParam:!0},{panel:r,header:e,setting:"debugRTTScores",initialValue:()=>l.debugRttScores,onChange:e=>{l.debugRttScores=e,e||n.setMeshOverlay({})},urlParam:!0}].forEach((e=>t.registerMenuEntry(e)))}))}},86465:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var i=n(68909),a=n(84440),r=n(59758),s=n(90082),o=n(26072),l=n(32502),d=n(47299),u=n(50839),g=n(22278),h=n(14240),c=n(39034),m=n(2593),M=n(71687),p=n(82240),y=n(98823),f=n(81662),T=n(72773);async function x(e){const t=await e.getModuleBySymbol(M.GR),[n,x,w]=await Promise.all([e.market.waitForData(r.o),e.getModuleBySymbol(s.ZF),e.getModuleBySymbol(M.UN)]);await x.loadPromise.then((()=>{let r=null;x.registerMenuEntry({header:"Mesh",setting:"Toggle Trim Bounds",initialValue:()=>!1,onChange:n=>{r||(r=new p.U,e.getModuleBySymbol(M.M7).then((e=>null==r?void 0:r.addToScene(e.getScene()))));for(const e of t.meshTrimData.meshTrimsById.values)r.boxWire(e.id,{color:-1===e.meshGroup?new i.Color("red"):(0,a.Mq)(e.meshGroup)}).update(e.position,e.scale.clone().multiplyScalar(.5),e.rotation).toggle(n)},urlParam:!0}),x.registerButton("Mesh","Toggle visible",(()=>{t.meshes.forEach((e=>{e.modelMesh.visible=!e.modelMesh.visible}))})),x.registerButton("Mesh","Toggle UV debug",(()=>{const e=t.meshes.entries()[0][1].renderer.chunkRenderingModeOverride?null:l.f.UV;t.setChunkRenderingMode(e)})),x.registerButton("Mesh","Toggle depth",(()=>{const e=t.meshes.entries()[0][1].renderer.chunkRenderingModeOverride?null:l.f.Depth;t.setChunkRenderingMode(e)})),x.registerButton("Mesh","Toggle transparent",(()=>{const e=t.meshes.entries()[0][1].renderer.chunkRenderingModeOverride?null:l.f.Transparent;t.setChunkRenderingMode(e)})),x.registerButton("Mesh","Toggle wireframe",(()=>{const e=t.meshes.entries()[0][1].renderer.chunkRenderingModeOverride?null:l.f.Wireframe;t.setChunkRenderingMode(e)}));let s=!0===Boolean(new URLSearchParams(window.location.search).get("flat"));const v=()=>{t.meshes.forEach((e=>{e.modelMesh instanceof c.f&&e.modelMesh.notifyOnChunksLoaded((e=>{for(const t of e)t.setFlatShading(s)}));for(const t of e.modelMesh.chunks)t.setFlatShading(s)}))};v(),x.registerButton("Mesh","Toggle flat shading",(()=>{s=!s,v()}));const b=(()=>{let e=!1;return(n,r)=>{const s=new i.Vector4(1,1,1,0);var o;e=!e,o=n||e,t.meshes.forEach((e=>{for(const t of e.modelMesh.chunks){const e=r?100*t.id:100*t.meshSubgroup,n=o?(0,a.Zd)(.5,e):s;t.setColorOverlay(n)}}))}})();x.registerButton("Mesh","Highlight Rooms",b),x.registerButton("Mesh","Highlight Chunks",(()=>b(!0,!0))),x.registerButton("Mesh","Random Mesh Trims",(()=>async function(e,t){const n=[],{meshBounds:a}=await t.market.waitForData(g.U),{meshTrimData:r}=await t.getModuleBySymbol(M.GR);for(let t=0;t<e;t++){const e=new h.e(new i.Vector3((0,y.YR)(a.min.x,a.max.x),(a.min.y+a.max.y)/2,(0,y.YR)(a.min.z,a.max.z)),new i.Vector3((0,y.YR)(.1,2),a.getSize(new i.Vector3).y+.1,(0,y.YR)(.1,2)),(new i.Quaternion).setFromAxisAngle(f.B1.UP,Math.random()*Math.PI),Number.MAX_SAFE_INTEGER,!0,T.Zu,new Date,new Date,void 0,"temp",!0,!0);e.transient=!0,n.push(e)}r.add(...n)}(5,e))),n.onSettingChanged(d.Vp,(e=>{t.meshes.forEach((t=>{const n=w.getFullBounds();for(const i of t.modelMesh.chunks)i.setMaterialsUniform({floorTrimHeight:1-e/100,floorHeightMin:n.min.y,floorHeightMax:n.max.y},!0)}))}));const S=(e,t,i,a,r)=>{x.registerSetting(e,t,i,!0,o.u.NONE,r),n.onSettingChanged(t,a)};S("Wireframe",d._Z,!1,(e=>{t.meshes.forEach((t=>{for(const n of t.modelMesh.chunks)n.setWireframe(e)}))}));const E={[u.d.Wireframe]:{Wireframe:["thickness","wireframeOpacity","stroke","fillEnabled","fill","insideAltColor","dualStroke","secondThickness"],"Wireframe Dashes":["dashEnabled","dashLength","dashAnimate","dashOverlap"],"Wireframe Advanced":["squeeze","squeezeMin","squeezeMax"]}};for(const e in E){const n=m.f.uniforms[e];for(const i in E[e])for(const a of E[e][i])S(i,a,n[a].value,(e=>{t.meshes.forEach((t=>{for(const n of t.modelMesh.chunks)n.setMaterialsUniform({[a]:e})}))}),n[a].range)}}))}},8072:(e,t,n)=>{n.r(t),n.d(t,{DEBUG_TILEDMESH_SETTINGS:()=>T,default:()=>R,tiledMeshDebugMenu:()=>P});var i=n(68909),a=n(90082),r=n(3066);function s(e,t=16){let n;const i=(0,r.Sh)((()=>n=window.setInterval((()=>e()),t)),(()=>{n&&clearInterval(n)}));return i.cancel(),i}var o=n(244),l=n(24241),d=n(75778),u=n(71687),g=n(42120),h=n(84440),c=n(25712),m=n(32484),M=n(47299),p=n(15564);const y=new l.Vy("tiled-mesh"),{TILEDMESH_SETTINGS:f}=m.yJ,T={hideMenu:"1"!==(0,d.P3)("dmenu","0"),debug:"1"===(0,d.P3)("debugTiles","0")||"1"===(0,d.P3)("debug-tiles","0"),statsTiles:!1,statsTileset:!0,statsTextures:!0,statsTextureStream:!0};let x=null;function w(e,t,n){x||(x=document.createElement("div"),x.style.color="#FFFFFF",x.style.fontFamily="Roboto",x.style.fontWeight="300",x.style.fontSize="12px",x.style.position="absolute",x.style.top="85px",x.style.width="500px",x.style.pointerEvents="none",x.style.whiteSpace="pre",x.style.zIndex="99999",x.style.textShadow="0 0 1px black, 0 0 1px black, 0 0 1px black, 0 0 1px black",document.body.appendChild(x));let i="\n\n";i+=function(e){const t=e.threeRenderer.info,n=`three:\n  drawCalls: ${t.render.calls}\n  geometries: ${t.memory.geometries}\n  textures: ${t.memory.textures}\n  triangles: ${t.render.triangles}\n  memory allocated (megs): ${Math.floor(e.estimatedGPUMemoryAllocated()/2**20)}`;return n}(e),i+=T.statsTextureStream?function(e){const t=`\ntextureStreaming:\n  downloadingTiles: ${e.downloadingTiles} / ${e.totalTiles}\n  downloadingTextures: ${e.loadingTextures}\n`,n="  downloaded:\n"+Object.keys(e.totalTextures).map((t=>`    ${t}: ${e.totalTextures[t]} `)).join("\n")+"\n";return t+n}(n):"",t.forEach(((e,t)=>{const n=e.modelMesh;i+=`\n\n<mesh: id:${t}>`,i+=T.statsTileset?function(e,t){var n,i,a;const r=e.tilesRenderer,s=Object.values(null!==(n=r.tileSets)&&void 0!==n?n:[])[0];return`\n  tileset: preset: ${null===(i=null==s?void 0:s.asset.extras)||void 0===i?void 0:i.preset}, depth: ${null===(a=null==s?void 0:s.asset.extras)||void 0===a?void 0:a.depth}, version: ${null==s?void 0:s.asset.tilesetVersion}\n  view: errorTarget: ${t.settings.errorTarget}, maxLOD: ${t.settings.maxLOD}, detail: '${t.detail}'\n`}(n.tileLoader,n):"",i+=T.statsTiles?function(e){const t=e.tilesRenderer,n=t.visibleTiles,i={};n.forEach((e=>{var t;const n=`lod${null===(t=e.extras)||void 0===t?void 0:t.level}`,a=i[n]||0;i[n]=a+1}));const{stats:a,downloadQueue:r,parseQueue:s,lruCache:o}=t,{active:l,downloading:d,inFrustum:u,parsing:g,used:h,visible:c}=a,m=`  tiles:\n    tiles in frustum: ${u}\n    visible: ${c}`+Object.keys(i).sort().map((e=>`\n     ${e} tiles: ${i[e]||0}`)).join()+`\n    downloading gltf: ${d}\n    parsing gltf: ${g}\n    active: ${l}\n    used: ${h}\n    queues:\n      download: ${r.currJobs} running, ${r.items.length} waiting\n      parse: ${s.currJobs} running, ${s.items.length} waiting\n    lruCache: ${o.itemSet.size}\n`;return m}(n.tileLoader):"",i+=`</mesh: id:${t}>`})),x.textContent=i}function v(e,t,n,a,r,o){E&&(e.forEach(((e,n)=>{S.has(e.modelMesh)||(S.add(e.modelMesh),b.push(...function(e,t,n,a){const r=[{panel:e,header:t.tile+": "+n,setting:"maxLOD: "+n,initialValue:()=>a.settings.maxLOD,onChange:e=>{a.settings.maxLOD=e},range:[0,4],rangePrecision:0},{panel:e,header:t.tile+": "+n,setting:"nonMeshMaxLOD: "+n,initialValue:()=>a.settings.nonMeshMaxLOD,onChange:e=>{a.settings.nonMeshMaxLOD=e},range:[0,4],rangePrecision:0},{panel:e,header:t.tile+": "+n,setting:"minLOD: "+n,initialValue:()=>a.settings.minLOD,onChange:e=>{a.settings.minLOD=e},range:[0,4],rangePrecision:0},{panel:e,header:t.tile+": "+n,setting:"errorTarget:"+n,initialValue:()=>a.settings.errorTarget,onChange:e=>{a.settings.errorTarget=e},range:[0,20],rangePrecision:1,urlParam:!0},{panel:e,header:t.tile+": "+n,setting:"disableTileUpdates:"+n,initialValue:()=>a.settings.disableTileUpdates,onChange:e=>{a.settings.disableTileUpdates=e}},{panel:e,header:t.tile+": "+n,setting:"disposeModel: "+n,initialValue:()=>a.settings.disposeModel,onChange:e=>{a.settings.disposeModel=e}},{panel:e,header:t.tile+": "+n,setting:"pos on z axis: "+n,initialValue:()=>0,onChange:e=>{a.position.copy(new i.Vector3(0,0,e)),a.updateMatrixWorld(!0)},range:[-100,100],rangePrecision:0}];return r}(t,a,n,e.modelMesh)),b.push(...function(e,t,n,i,a,r){const o=i.tileLoader,l=V(o,r,((e,t)=>e.setWireframe(t))),d=function(e,t){const n={scale:1},i=(t,i)=>{if(!t)return;const a=e.container.tilesByChunkId.get(t.id),r=(null==a?void 0:a.__error)||1e-4,s=t.lod!==f.maxLOD&&r>f.errorTarget?1:.5,o=Math.max(0,Math.min(1,1-n.scale/r)),l=i?B(t.lod,o,s):null;t.setColorOverlay(l)},a=V(e,t,i),r=s((()=>a.colorize(e.container.chunks)));return{toggle:e=>{e?r.renew():r.cancel(),a.toggle(e)},colorize:a.colorize,subscription:r,config:n}}(o,r),u=V(o,r,((e,t)=>{e.setColorOverlay(t?B(e.lod,1,.5):null)})),g=V(o,r,((e,t)=>{e.setColorOverlay(t?(0,h.Zd)(.5,e.id||0):null)})),m=V(o,r,((e,t)=>{var n;const i=o.container.tilesByChunkId.get(e.id);e.setColorOverlay(t?(0,h.Zd)(.5,(0,c.s5)((null===(n=null==i?void 0:i.content)||void 0===n?void 0:n.uri)||"missing")||0):null)})),M=V(o,r,((e,t)=>{e.setColorOverlay(t?(0,h.Zd)(.5,(e.meshGroup<<16)+e.meshSubgroup||0):null)})),p=V(o,r,((e,t)=>{e.setColorOverlay(t?(0,h.Zd)(.5,e.meshSubgroup||0):null)})),T=V(o,r,((e,t)=>{e.setColorOverlay(t?(0,h.Zd)(.5,e.meshGroup||0):null)})),x=V(o,r,((e,t)=>{e.setColorOverlay(t?(0,h.Zd)(.5,(0,c.s5)(e.textureName)||0):null)})),w=V(o,r,((e,t)=>{const n=o.container.tilesByChunkId.get(e.id);e.setColorOverlay(t?(0,h.Zd)(.5,(null==n?void 0:n.geometricError)||0):null)})),v=a.slots,b=i.textureQualityMap,S=V(o,r,((e,t)=>{const n=v.find((t=>t.textureName===e.textureName));if(n){const i=n.loading?1:n.quality>b.min(e.lod)?.7:.3,a=b.maxTexelSize/b.get(n.quality).texelSize;e.setColorOverlay(t?B(e.lod,a,i):null)}})),E=s((()=>S.colorize(o.container.chunks)));let C="none";const P={none:void 0,byError:d,byGeometricError:w,byTile:m,bySubgroup:p,byMeshgroup:T,bySubAndMeshgroup:M,byTexture:x,byStreamedTextures:{subscription:E,toggle:e=>{e?E.renew():E.cancel(),e&&y.info("colorize=byStreamedTextures solid color: loading, dark color: streamed, light color: basis"),S.toggle(e)}},byChunk:g,byLod:u},O=[{panel:e,header:`${t.viz}: ${n}`,setting:"disableTileUpdates:"+n,initialValue:()=>i.settings.disableTileUpdates,onChange:e=>{i.settings.disableTileUpdates=e},urlParam:!0},{panel:e,header:`${t.viz}: ${n}`,setting:"wireframe:"+n,initialValue:()=>!1,onChange:l.toggle,urlParam:!0},{panel:e,header:`${t.viz}: ${n}`,setting:"colorize:"+n,initialValue:()=>"none",onChange:e=>{var t,n;null===(t=P[C])||void 0===t||t.toggle(!1),null===(n=P[e])||void 0===n||n.toggle(!0),C=e},options:Object.keys(P),urlParam:!0},{panel:e,header:`${t.viz}: ${n}`,setting:"colorizeByErrorScale:"+n,initialValue:()=>1,onChange:e=>{d.config.scale=e},range:[0,6],rangePrecision:3,urlParam:!0}];return O}(t,a,n,e.modelMesh,r,o)))})),b.length&&(b.forEach((e=>n.registerMenuEntry(e))),b.length=0))}const b=[],S=new Set;let E=!1,C=null;async function P(e){if(!T.debug)return;const t=await e.getModuleBySymbol(a.ZF),n=await e.getModuleBySymbol(u.mL),i=await e.getModuleBySymbol(u.M7),r=i.getScene(),s=await e.getModuleBySymbol(u.GR);await s.firstMeshLoadPromise,await(0,g.c)(100);const o=s.meshes,l=s.meshTextureLoader,d=t.tryGetSetting(M.sz,!1),h=t.addPanel(p.F.TITLE,p.F.HOTKEYS,{width:350}),c={viz:"visualize",stats:"stats",tile:"tileset",log:"log"};function m(){C||(C=setInterval((()=>{w(i,o,l),v(o,h,t,c,l,e)}),150))}const x=[{panel:h,header:c.stats,setting:"tilesetStatsOverlay",initialValue:()=>T.statsTileset,onChange:e=>{T.statsTileset=e,e&&m()},urlParam:!0},{panel:h,header:c.stats,setting:"tileStatsOverlay",initialValue:()=>T.statsTiles,onChange:e=>{T.statsTiles=e,e&&m()},urlParam:!0},{panel:h,header:c.stats,setting:"textureStatsOverlay",initialValue:()=>T.statsTextures,onChange:e=>{T.statsTextures=e,e&&m()},urlParam:!0},{panel:h,header:c.stats,setting:"textureStreamingOverlay",initialValue:()=>T.statsTextureStream,onChange:e=>{T.statsTextureStream=e,e&&m()},urlParam:!0}],b=[{panel:h,header:c.log,buttonName:"Log: App State",callback:()=>{y.warn(o),y.warn(n),y.warn(r),y.warn(t)}}];d&&(T.hideMenu||await(0,g.c)(1e3).then((()=>{t.getSettingsGui().loadGuiPackage().then((()=>{t.getSettingsGui().toggle(t.getMainPanelId()),t.getSettingsGui().toggle(t.getMainPanelId())}))})),await(0,g.c)(16),E||(await(0,g.c)(16),E=!0,function(e,t,n,i){const a=[{panel:e,header:t.tile,setting:"smallMeshThreshold",initialValue:()=>f.smallMeshThreshold,onChange:e=>{f.smallMeshThreshold=e,i.forEach((t=>{t.modelMesh.settings.smallMeshThreshold=e}))},range:[0,100],rangePrecision:1,urlParam:!0},{panel:e,header:t.tile,setting:"smallMeshErrorMultiplier",initialValue:()=>f.smallMeshErrorMultiplier,onChange:e=>{f.smallMeshErrorMultiplier=e,i.forEach((t=>{t.modelMesh.settings.smallMeshErrorMultiplier=e}))},range:[.01,2],rangePrecision:2,urlParam:!0},{panel:e,header:t.tile,setting:"displayActiveTiles",initialValue:()=>f.displayActiveTiles,onChange:e=>{f.displayActiveTiles=e,i.forEach((t=>{t.modelMesh.settings.displayActiveTiles=e}))},urlParam:!0},{panel:e,header:t.tile,setting:"loadSiblings",initialValue:()=>f.loadSiblings,onChange:e=>{f.loadSiblings=e,i.forEach((t=>{t.modelMesh.settings.loadSiblings=e}))},urlParam:!0},{panel:e,header:t.tile,setting:"autoDisableRendererCulling",initialValue:()=>f.autoDisableRendererCulling,onChange:e=>{f.autoDisableRendererCulling=e,i.forEach((t=>{t.modelMesh.settings.autoDisableRendererCulling=e}))},urlParam:!0},{panel:e,header:t.tile,setting:"stopAtEmptyTiles",initialValue:()=>f.stopAtEmptyTiles,onChange:e=>{f.stopAtEmptyTiles=e,i.forEach((t=>{t.modelMesh.settings.stopAtEmptyTiles=e}))},urlParam:!0},{panel:e,header:t.tile,setting:"limitMemoryUsage",initialValue:()=>f.limitMemoryUsage,onChange:e=>{f.limitMemoryUsage=e,i.forEach((t=>{t.modelMesh.settings.limitMemoryUsage=e}))},urlParam:!0},{panel:e,header:t.tile,setting:"allocatedMegsBeforeLimitingLod",initialValue:()=>f.allocatedMegsBeforeLimitingLod,onChange:e=>{f.allocatedMegsBeforeLimitingLod=e,i.forEach((t=>{t.modelMesh.settings.allocatedMegsBeforeLimitingLod=e}))},urlParam:!0,range:[100,1e3]},{panel:e,header:t.tile,setting:"lruMinExtraTiles",initialValue:()=>f.lruMinExtraTiles,onChange:e=>{f.lruMinExtraTiles=e,i.forEach((t=>{t.modelMesh.settings.lruMinExtraTiles=e}))},urlParam:!0,range:[0,2e3]},{panel:e,header:t.tile,setting:"lruMaxTiles",initialValue:()=>f.lruMaxTiles,onChange:e=>{f.lruMaxTiles=e,i.forEach((t=>{t.modelMesh.settings.lruMaxTiles=e}))},urlParam:!0,range:[0,2e3]},{panel:e,header:t.tile,setting:"lruUnloadPercent",initialValue:()=>f.lruUnloadPercent,onChange:e=>{f.lruUnloadPercent=e,i.forEach((t=>{t.modelMesh.settings.lruUnloadPercent=e}))},urlParam:!0,range:[0,1]},{panel:e,header:"Priority",setting:"errorMultiplierRaycastOcclusion",initialValue:()=>f.errorMultiplierRaycastOcclusion,onChange:e=>{f.errorMultiplierRaycastOcclusion=e,i.forEach((t=>{t.modelMesh.settings.errorMultiplierRaycastOcclusion=e}))},range:[.001,1],rangePrecision:2},{panel:e,header:"Priority",setting:"errorMultiplierHiddenFloors",initialValue:()=>f.errorMultiplierHiddenFloors,onChange:e=>{f.errorMultiplierHiddenFloors=e,i.forEach((t=>{t.modelMesh.settings.errorMultiplierHiddenFloors=e}))},range:[.001,1],rangePrecision:2}];return a}(h,c,0,o).forEach((e=>t.registerMenuEntry(e))),x.forEach((e=>t.registerMenuEntry(e))),b.forEach((e=>t.registerMenuButton(e)))))}function V(e,t,n){let i=!1;const a=e=>{t.after(o.R.End).then((()=>{e.forEach((e=>{e&&n(e,i)}))}))},r=e.notifyOnChunksLoaded(a);r.cancel();return{toggle:t=>{t?r.renew():r.cancel(),t!==i&&(i=t,a([...e.container.chunks]))},colorize:a,subscription:r}}const O={0:new i.Vector4(1,0,0,1),1:new i.Vector4(0,1,0,1),2:new i.Vector4(0,0,1,1),3:new i.Vector4(1,1,1,1),4:new i.Vector4(1,0,1,1),5:new i.Vector4(0,1,1,1),6:new i.Vector4(1,1,0,1),7:new i.Vector4(0,0,0,1)};function B(e,t,n){var a,r;const s=null!==(r=null===(a=O[e])||void 0===a?void 0:a.clone())&&void 0!==r?r:new i.Vector4;return s.multiplyScalar(t),s.setW(n),s}const R=P},15564:(e,t,n)=>{n.d(t,{F:()=>i});const i={TITLE:"streamed-mesh (T)",HOTKEYS:[n(71397).D.T]}},32484:(e,t,n)=>{n.d(t,{yJ:()=>s});var i=n(80112),a=n(47299),r=n(14971);const s={TEXTURE_SETTINGS:a.Ay,TILEDMESH_SETTINGS:i.W,clearRaycastHits:r.Jn}},14240:(e,t,n)=>{n.d(t,{e:()=>d});var i=n(68909),a=n(85616),r=n(35535),s=n(30443),o=n(45205);const l=new i.Vector3;class d extends a.v{constructor(e,t,n,a,r,s,l=new Date,d=new Date,u,g,h,c){super(),this.position=e,this.scale=t,this.rotation=n,this.enabled=r,this.meshGroup=s,this.created=l,this.modified=d,this.discardContents=!0,this.activeInPanoMode=!0,this.transient=!1,this._rotationMatrix=new i.Matrix4,this._matrix=new i.Matrix4,this.id=u||`${this.meshGroup}`+(0,o.D)(11),this.index=a,this.name=g,this.discardContents=void 0===h||h,this.activeInPanoMode=void 0===c||c}get sid(){return this.id}isPointTrimmed(e,t){return!!this.enabled&&(!(t&&!this.activeInPanoMode)&&(this.discardContents?this.isPointInside(e):!this.isPointInside(e)))}getTransformationMatrix(e){return(e=e||new i.Matrix4).compose(this.position,this.rotation,this.scale),e}getInverseTransformationMatrix(e){return(e=this.getTransformationMatrix(e)).invert(),e}isPointInside(e){this.getInverseTransformationMatrix(this._matrix);const t=l.copy(e).applyMatrix4(this._matrix);return t.x<.5&&t.x>-.5&&t.y<.5&&t.y>-.5&&t.z<.5&&t.z>-.5}updateRotationMatrix(){const e=this.rotation,t=this.rotation.clone().set(e.x,e.y,e.z,-e.w);this._rotationMatrix.makeRotationFromQuaternion(t.normalize())}get rotationMatrix(){return this.updateRotationMatrix(),this._rotationMatrix}static getUnitAABB(){return new i.Box3(new i.Vector3(-.5,-.5,-.5),new i.Vector3(.5,.5,.5))}getContainingAABB(){const e=d.getUnitAABB(),t=(0,s.jF)(e),n=this.getTransformationMatrix();return(0,s.nD)(t,e,n)}getOBB(){const e=(new i.Matrix4).makeRotationFromQuaternion(this.rotation),t=(new i.Matrix3).setFromMatrix4(e);return new r.OBB(this.position,this.scale.clone().multiplyScalar(.5),t)}}},79243:(e,t,n)=>{n.d(t,{n:()=>i});const i=(e,t)=>{let n,i=Date.now()-t;return(...a)=>{const r=Date.now()-i,s=()=>{e.apply(null,a),i=Date.now()};if(n&&clearTimeout(n),r>=t)s();else{const e=t-r;n=window.setTimeout(s,e)}}}}}]);