/*! For license information please see 5476.42b1c4541b56a9bf789f.js.LICENSE.txt */
"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[5476],{73927:(t,i,s)=>{s.d(i,{h:()=>n});var e=s(89103);class n extends e.QB{constructor(t,i){super(),this.width=t,this.height=i}}},45395:(t,i,s)=>{var e;s.d(i,{D:()=>e}),function(t){t[t.Immediate=0]="Immediate",t[t.NextFrame=1]="NextFrame",t[t.Duration=2]="Duration",t[t.Manual=3]="Manual",t[t.Debounced=4]="Debounced"}(e||(e={}))},76234:(t,i,s)=>{s.d(i,{Xw:()=>e,gj:()=>h,jz:()=>d});var e,n=s(79070),a=s(21440),r=s(244),o=s(45395);!function(t){t.added="added",t.removed="removed",t.updated="updated"}(e||(e={}));class h{constructor(t,i,s){this.index=t,this.action=i,this.diff=s}}class d{constructor(t,i){if(this.changedHandlers=[],this.awaitingInvoke=!1,this.diffRecord=[],this.targetMonitors={},this.triggerChangeHandlers=this.invokeChangeHandlers.bind(this),this.config=t,this.updatePhaseSync=i,this.config.aggregationType===o.D.NextFrame){if(!i)throw Error("UpdatePhaseSync required for NextFrame aggregation")}else{if(this.config.aggregationType===o.D.Duration)throw Error("Aggregation Type not implemented");this.config.aggregationType===o.D.Debounced&&(this.triggerChangeHandlers=(0,n.s)(this.invokeChangeHandlers.bind(this),t.aggregationDuration))}}hasDiffRecord(){return this.diffRecord.length>0}clearDiffRecord(){this.diffRecord=[];for(const t in this.targetMonitors){const i=this.targetMonitors[t];i.hasDiffRecord()&&i.clearDiffRecord()}this.awaitingInvoke=!1}onChanged(t){this.changedHandlers.push(t)}removeOnChanged(t){(0,a.Nz)(this.changedHandlers,t)}invokeCallbacks(t){if(this.changedHandlers.length>0)for(const i of this.changedHandlers)i(t)}invokeChangeHandlers(t){var i;switch(this.config.aggregationType){case o.D.Immediate:case o.D.Debounced:this.invokeCallbacks(t);break;case o.D.NextFrame:this.awaitingInvoke||(this.awaitingInvoke=!0,null===(i=this.updatePhaseSync)||void 0===i||i.after(r.R.End).then((()=>{this.awaitingInvoke&&(this.invokeCallbacks(t),this.awaitingInvoke=!1)})));case o.D.Manual:}}}},35473:(t,i,s)=>{s.d(i,{F:()=>r});var e=s(28913),n=s(76234),a=s(2391);class r extends n.jz{constructor(t,i,s){super(i,s),this.target=t;for(const e of t.keys){const n=t.get(e),r=new a.V(n,i,s);r.onChanged(this.triggerChangeHandlers),this.targetMonitors[e]=r}const r={onAdded:(t,r)=>{const o=new a.V(t,i,s);o.onChanged(this.triggerChangeHandlers),this.targetMonitors[r]=o;const h=this.diffRecord.findIndex((t=>t.index===r));-1!==h&&this.diffRecord.splice(h,1);const d=new n.gj(r,n.Xw.added,(0,e.A4)(t));-1===h&&this.diffRecord.push(d),this.triggerChangeHandlers(d)},onRemoved:(t,i)=>{delete this.targetMonitors[i];const s=this.diffRecord.findIndex((t=>t.index===i));-1!==s&&this.diffRecord.splice(s,1);const a=new n.gj(i,n.Xw.removed,(0,e.A4)(t));-1===s&&this.diffRecord.push(a),this.triggerChangeHandlers(a)}};this.target.onElementChanged(r)}commitChanges(){this.invokeCallbacks(this.getDiffRecord())}getDiffRecord(){const t=[];for(const i in this.targetMonitors){const s=this.targetMonitors[i];if(s.hasDiffRecord()){const a=s.getDiffRecord(),r=this.diffRecord.findIndex((t=>t.index===i));-1!==r?(0,e.h1)(this.diffRecord[r].diff,a):t.push(new n.gj(i,n.Xw.updated,a))}}return this.diffRecord.concat(t)}}},2391:(t,i,s)=>{s.d(i,{V:()=>h});var e=s(79070),n=s(21440),a=s(28913),r=s(244),o=s(45395);class h{constructor(t,i,s){this.updatePhaseSync=s,this.target=t,this.clearDiffRecord(),this.aggregationType=i.aggregationType,this.aggregationType===o.D.Debounced&&(this.handleAggregation=(0,e.s)(this.handleAggregation.bind(this),i.aggregationDuration||30)),this.target.onChanged((()=>{this.diffRecord=(0,a.bB)(this.originalData,(0,a.A4)(this.target),i.shallow),this.handleAggregation()})),this.changedHandlers=[]}hasDiffRecord(){return Object.keys(this.diffRecord).length>0}getDiffRecord(){return this.diffRecord}clearDiffRecord(){this.originalData=(0,a.A4)(this.target),this.diffRecord={}}onChanged(t){this.changedHandlers.push(t)}removeOnChanged(t){(0,n.Nz)(this.changedHandlers,t)}commitChanges(){this.triggerChangeHandlers(this.diffRecord)}handleAggregation(){switch(this.aggregationType){case o.D.Immediate:this.triggerChangeHandlers(this.diffRecord);break;case o.D.NextFrame:if(!this.updatePhaseSync)throw new Error("handleAggregation() -> Next frame aggregation requested, but updatePhaseSync is null");this.nextFramePromise||(this.nextFramePromise=this.updatePhaseSync.after(r.R.Begin).then((()=>{this.triggerChangeHandlers(this.diffRecord)})).finally((()=>{this.nextFramePromise=void 0})));break;case o.D.Debounced:this.triggerChangeHandlers(this.diffRecord);break;case o.D.Duration:throw new Error("AggregationType.Duration: Please implement me :)");case o.D.Manual:}}triggerChangeHandlers(t){if(this.changedHandlers.length>0)for(const i of this.changedHandlers)i(t)}}},15404:(t,i,s)=>{var e;s.d(i,{p:()=>e}),function(t){t.BLURS="blurs",t.BLUR_SUGGESTIONS="blur-suggestions",t.FLOORS="floors",t.HIGHLIGHTS="highlights",t.LABELS="labels",t.MATTERTAGS="mattertags",t.MEASUREMENTS="measurements",t.NOTES="notes",t.OBJECT_ANNOTATIONS="objectAnnotations",t.ORDERED_LISTS="orderedLists",t.PHOTOS="photos",t.PLUGINS="plugins",t.SETTINGS="settings",t.START_LOCATION="startlocation",t.SWEEPS="sweeps",t.LAYERS="layers",t.ROOM_BOUNDS="room_bounds"}(e||(e={}))},76924:(t,i,s)=>{s.r(i),s.d(i,{ResizeProperty:()=>h,default:()=>p});var e=s(75578),n=s(37105),a=s(73927),r=s(89103);class o extends r.QB{constructor(t,i){super(),this.x=t,this.y=i}}var h,d=s(31093),c=s(52018),g=s(58095),u=s(10459);class l extends c.t{}!function(t){t.left="left",t.top="top",t.width="width",t.height="height"}(h||(h={}));const f={[h.width]:"width",[h.height]:"height",[h.top]:"top",[h.left]:"left"};class p extends e.n{constructor(){super(...arguments),this.name="canvas",this.getNewX=()=>0,this.getNewY=()=>0,this.getNewWidth=t=>t.width,this.getNewHeight=t=>t.height,this.activeTransitions=[],this.activeTransitionMap={left:null,top:null,width:null,height:null},this.onResize=t=>{t.propertyName in h&&(this.resolveActiveTransition(t.propertyName),this._canvas.style.transitionDuration=this.stringifyTransitionDurations())},this.onContainerResize=()=>{this.transitionDurations.left=this.transitionDurations.top=this.transitionDurations.width=this.transitionDurations.height="0s",this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition(),this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),this._canvas.style.transitionDuration=this.stringifyTransitionDurations()}}async init(t,i){if(this.engine=i,!t.container)throw new l;this.container=t.container,this.container.appendChild(t.canvas),this.containerBounds=this.container.getBoundingClientRect(),this._canvas=t.canvas,this._canvas.style.position="absolute",this._canvas.style.left="0",this._canvas.style.top="0",this.transitionDurations={left:"0s",top:"0s",width:"0s",height:"0s",filter:"0.4s"},this._canvas.style.transitionProperty=Object.keys(this.transitionDurations).join(","),this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.updateTransitions(),this.bindings.push(i.subscribe(g.P,this.onContainerResize),this.makeTransitionEndSubscription());for(const t of this.bindings)t.renew();this.canvasBounds=this._canvas.getBoundingClientRect(),this.containerBounds=this.container.getBoundingClientRect(),this.data=new n.p(this.canvasBounds.width,this.canvasBounds.height,this._canvas),i.market.register(n.p,this.data),this.cameraData=await this.engine.market.waitForData(u.M)}async resizeCanvas(t){return 0===t.length?[]:(this.cameraData&&!this.cameraData.canTransition()&&await this.cameraData.transition.promise,this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),t.forEach((t=>{const{property:i,setDimension:s,duration:e=0}=t,n=f[i],a=this._canvas.style[n];switch(i){case h.height:this.setHeight(s,e);break;case h.width:this.setWidth(s,e);break;case h.top:this.setY(s,e);break;case h.left:this.setX(s,e)}if(this._canvas.style[n]!==a&&e>0){const t=new d.i;t.then((()=>{clearTimeout(s)}));const s=setTimeout((()=>{this.resolveActiveTransition(i)}),e+500);this.activeTransitionMap[i]=t,this.activeTransitions.push(i)}})),this.hasActiveTransitions()||(this.canvasBounds=this._canvas.getBoundingClientRect()),this.getTransitionPromise())}makeTransitionEndSubscription(){let t=!1;return{renew:()=>{t||(this.element.addEventListener("transitionend",this.onResize),t=!0)},cancel:()=>{t&&(this.element.removeEventListener("transitionend",this.onResize),t=!1)}}}dispose(t){super.dispose(t)}get element(){return this._canvas}get width(){return this.canvasBounds.width}get height(){return this.canvasBounds.height}get x(){return this.canvasBounds.left}get y(){return this.canvasBounds.top}onUpdate(){const t=this.container.getBoundingClientRect(),i=this.containerHasChanged(t);i&&(this.containerBounds=t,this.updateTransitions()),(i||this.hasActiveTransitions())&&(this.canvasBounds=this._canvas.getBoundingClientRect());const s=this.data.width!==this.width||this.data.height!==this.height,e=this.data.x!==this.x||this.data.y!==this.y;s&&(this.data.width=this.width,this.data.height=this.height,this.data.commit(),this.engine.broadcast(new a.h(this.width,this.height))),e&&(this.data.x=this.x,this.data.y=this.y,this.data.commit(),this.engine.broadcast(new o(this.x-this.containerBounds.left,this.y-this.containerBounds.top)))}containerHasChanged(t){return t.left!==this.containerBounds.left||t.top!==this.containerBounds.top||t.width!==this.containerBounds.width||t.height!==this.containerBounds.height}setX(t,i=0){this.getNewX="number"==typeof t?()=>t:t,this.transitionDurations.left=`${i}ms`,this.updateTransitions()}setY(t,i=0){this.getNewY="number"==typeof t?()=>t:t,this.transitionDurations.top=`${i}ms`,this.updateTransitions()}setWidth(t,i=0){this.getNewWidth="number"==typeof t?()=>t:t,this.transitionDurations.width=`${i}ms`,this.updateTransitions()}setHeight(t,i=0){this.getNewHeight="number"==typeof t?()=>t:t,this.transitionDurations.height=`${i}ms`,this.updateTransitions()}screenToCanvasPoint(t,i){return{x:t-this.x,y:i-this.y}}getTransitionPromise(){return Promise.all(this.activeTransitions.map((t=>this.activeTransitionMap[t])).filter((t=>!!t)))}updateTransitions(){this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition()}applySize(){this._canvas.style.width=`${this.getNewWidth(this.containerBounds)}px`,this._canvas.style.height=`${this.getNewHeight(this.containerBounds)}px`}applyPosition(){this._canvas.style.left=`${this.getNewX(this.containerBounds)}px`,this._canvas.style.top=`${this.getNewY(this.containerBounds)}px`}stringifyTransitionDurations(){return Object.keys(this.transitionDurations).map((t=>this.transitionDurations[t])).join(",")}resolveActiveTransition(t){this.canvasBounds=this._canvas.getBoundingClientRect();const i=this.activeTransitions.indexOf(t);-1!==i&&this.activeTransitions.splice(i,1);const s=this.activeTransitionMap[t];s&&s.resolve(),this.activeTransitionMap[t]=null,this.transitionDurations[t]="0s"}hasActiveTransitions(){return this.activeTransitions.length>0}}},58095:(t,i,s)=>{s.d(i,{H:()=>a,P:()=>n});var e=s(89103);class n extends e.QB{constructor(t,i){super(),this.width=t,this.height=i}}class a extends e.QB{constructor(t){super(),this.orientation=t}}},94790:(t,i,s)=>{s.d(i,{Qm:()=>o,SK:()=>n,Ve:()=>h,_w:()=>r,jF:()=>a});var e=s(92475);class n extends e.E{constructor(t,i,s,e,n,a=0){super(t),this.position=i,this.buttons=s,this.device=e,this.ctrlKey=n,this.pointerId=a}}class a extends e.E{constructor(t,i,s,e,n,a,r=0){super(t),this.ctrlKey=!1,this.position=i,this.clientPosition=n,this.delta=s,this.buttons=e,this.device=a,this.pointerId=r}}class r extends e.E{constructor(t,i,s,e,n,a,r,o=0){super(t),this.ctrlKey=!1,this.position=i,this.delta=s,this.buttons=e,this.timeSinceLastMove=n,this.fullDelta=a,this.device=r,this.pointerId=o}}class o extends e.E{constructor(t,i,s){super(t),this.position=i,this.pointer=s}}class h extends e.E{constructor(t,i,s,e,n){super(t),this.position=i,this.startPosition=s,this.fullDelta=e,this.pointer=n}}},44667:(t,i,s)=>{s.d(i,{s:()=>n});var e=s(92475);class n extends e.E{constructor(t,i,s){super(t),this.position=i,this.delta=s}}},60043:(t,i,s)=>{s.d(i,{k:()=>n});var e=s(49586);class n extends e.T{constructor(t,i,s){super(),this.key=t,this.state=i,this.modifiers=s}}},90834:(t,i,s)=>{s.d(i,{O:()=>a});var e=s(84710),n=s(44351);class a extends e.B{constructor(){super(...arguments),this.name="interaction",this._source=a.defaultSource,this._mode=a.defaultMode}static get defaultMode(){return n.o.Desktop}static get defaultSource(){return n.m.None}get mode(){return this._mode}get source(){return this._source}updateSource(t){this._source=t}updateMode(t){this._mode=t}hasController(t=this.mode){return t===n.o.VrWithController||t===n.o.VrWithTrackedController}isVR(t=this.mode){return t===n.o.VrOrientOnly||t===n.o.VrWithTrackedController||t===n.o.VrWithController||t===n.o.VrTransientPointer||-1!==t.indexOf(n.o.VrUnknown)}isMobile(t=this.mode){return t===n.o.Mobile}}},81530:(t,i,s)=>{s.d(i,{F:()=>n});var e=s(55141);class n extends e.u{constructor(t){super(),this.payload=t}}n.id="SAVE_COMMAND"},79243:(t,i,s)=>{s.d(i,{n:()=>e});const e=(t,i)=>{let s,e=Date.now()-i;return(...n)=>{const a=Date.now()-e,r=()=>{t.apply(null,n),e=Date.now()};if(s&&clearTimeout(s),a>=i)r();else{const t=i-a;s=window.setTimeout(r,t)}}}},28337:(t,i,s)=>{var e;s.d(i,{$:()=>e}),function(t){t[t.DOWN=0]="DOWN",t[t.PRESSED=1]="PRESSED",t[t.UP=2]="UP"}(e||(e={}))},72268:(t,i,s)=>{var e,n;s.d(i,{O:()=>n,m:()=>e}),function(t){t[t.PRIMARY=0]="PRIMARY",t[t.MIDDLE=1]="MIDDLE",t[t.SECONDARY=2]="SECONDARY",t[t.BACK=3]="BACK",t[t.FORWARD=4]="FORWARD",t[t.COUNT=5]="COUNT"}(e||(e={})),function(t){t[t.NONE=0]="NONE",t[t.PRIMARY=1]="PRIMARY",t[t.SECONDARY=4]="SECONDARY",t[t.MIDDLE=2]="MIDDLE",t[t.BACK=8]="BACK",t[t.FORWARD=16]="FORWARD",t[t.ALL=31]="ALL"}(n||(n={}))},51666:(t,i,s)=>{s.d(i,{Z:()=>n});var e=s(25481);function n(t){if(t&&"object"==typeof t&&"x"in t&&"y"in t&&"z"in t){const i=t;return(0,e.Et)(i.x)&&(0,e.Et)(i.y)&&(0,e.Et)(i.z)}return!1}}}]);