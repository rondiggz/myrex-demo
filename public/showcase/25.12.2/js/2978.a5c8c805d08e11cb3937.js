/*! For license information please see 2978.a5c8c805d08e11cb3937.js.LICENSE.txt */
"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[2978],{78671:(t,e,s)=>{s.d(e,{I:()=>a});const a="spaces.sdk.qa"},99622:(t,e,s)=>{s.d(e,{q:()=>o});var a=s(10843),i=s(99694),r=s.n(i),n=s(67536);class o{constructor(){this.event="mp_feature_usage",this.name="feature-usage-handler",this.handlers=[{msgType:n.P,func:(t,e)=>{const s=a.Ay.for(this),i=r()(e.data);s.debug(`tracking ${this.event} [${i.event_name}] event`,{payload:i}),t.track(this.event,i)}}]}}},67536:(t,e,s)=>{s.d(e,{P:()=>i});var a=s(89103);class i extends a.QB{constructor(t){super(),this.data=t}}},46957:(t,e,s)=>{s.d(e,{b:()=>n,d:()=>r});var a=s(31002),i=s(72268);const r=t=>t instanceof a.rX?t.button===i.m.PRIMARY:t.buttons===i.O.PRIMARY,n=(t,e)=>{var s;const a=(null===(s=e.parentElement)||void 0===s?void 0:s.clientWidth)||0,i=e.offsetLeft,r=e.offsetWidth,n=Math.max(60,Math.min(90,.08*r));return 0===i&&t>0&&t<n||!(i+r<a)&&t>a-n}},41837:(t,e,s)=>{s.d(e,{QZ:()=>r,To:()=>h,bV:()=>d,hR:()=>i,kC:()=>o,sN:()=>n,wx:()=>c,z:()=>u});var a=s(89103);class i extends a.QB{constructor(t){super(),this.data=t}}class r extends a.QB{constructor(t){super(),this.data=t}}class n extends a.QB{}class o extends a.QB{constructor(t,e){super(),this.sid=t,this.text=e}}class c extends a.QB{constructor(t,e,s){super(),this.sid=t,this.oldText=e,this.newText=s}}class h extends a.QB{constructor(t){super(),this.data=t}}class d extends a.QB{constructor(t){super(),this.data=t}}class u extends a.QB{constructor(t,e,s){super(),this.opened=t,this.viewmode=e,this.count=s}}a.QB},95522:(t,e,s)=>{s.d(e,{N:()=>i});var a=s(89103);class i extends a.QB{constructor(t){super(),this.rating=t}}},23431:(t,e,s)=>{var a;s.d(e,{I:()=>a}),function(t){t[t.RoomLabels=0]="RoomLabels",t[t.Normal=1]="Normal"}(a||(a={}))},58687:(t,e,s)=>{s.d(e,{M:()=>r});var a=s(84710),i=s(98848);class r extends a.B{constructor(t={}){super(),this.name="storage-data",this.lastPublished=null,this.transactionState=i.i.IDLE,this.isInProcessingSubState=!1,Object.assign(this,t)}setTransactionState(t){if(t!==this.transactionState){if(![this.transactionState,t].includes(i.i.IDLE))throw new Error(`Cannot transition from ${this.transactionState} to ${t}`);this.transactionState=t,this.transactionState===i.i.IDLE&&(this.isInProcessingSubState=!1),this.commit()}}setProcessingSubState(t){if(t&&this.transactionState===i.i.IDLE)throw new Error("Cannot be in a Processing sub-state while Transaction State is Idle");this.isInProcessingSubState=t,this.commit()}}},98848:(t,e,s)=>{var a,i;s.d(e,{i:()=>a,w:()=>i}),function(t){t.IDLE="idle",t.SAVING="saving"}(a||(a={})),function(t){t.ON="on",t.BEFORE="before",t.AFTER="after"}(i||(i={}))},85846:(t,e,s)=>{s.d(e,{xO:()=>c});var a,i=s(48539),r=s(50380);!function(t){t.GET="GET",t.POST="POST",t.PATCH="PATCH",t.PUT="PUT",t.DELETE="DELETE",t.OPTIONS="OPTIONS"}(a||(a={}));class n{constructor(){this._options={responseType:"json"}}get options(){const t=this._options;return t.headers=(0,r.v)(this.url,this._options.headers||{},void 0),t}}class o extends n{constructor(t){super(),this.config=t,this.url=t.path}async read(){const{deserialize:t}=this.config;let e=null;return this.config.cachedData&&this.config.cachedData.data?e=this.config.cachedData.data:(e=await this.config.queue.get(this.config.path,this.options),this.config.cachedData&&(this.config.cachedData.data=e)),t(e)}clearCache(){this.config.cachedData&&(this.config.cachedData.data=null)}}class c extends o{constructor(t){super(t),this.config=t,this.acceptsPartial=!1,this.config.batchUpdate="batchUpdate"in this.config&&this.config.batchUpdate}async create(t){throw Error("Not implemented")}updateBatch(t,e){const{serialize:s}=this.config,i=[],r=[...new Set([...Object.keys(t),...Object.keys(e)])];for(const s of r){t[s]||e[s]||i.push(this.config.queue.delete(`${this.config.path}/${s}`,this.options))}const n=s(t,e),o=Object.assign(Object.assign({},this.options),{body:n});return i.push(this.config.queue.request(this.config.httpMethod||a.POST,this.config.path,o)),Promise.all(i)}updateInternal(t,e){const{serialize:s}=this.config,r=[],n=Object.assign({},this.options),o=Object.keys(t),c=Object.keys(e),h=(0,i.ij)(o.concat(c));for(const i in h){const o=h[i],c=t[o]||e[o];if(c){const t={};t[o]=c;const i={},h=e[o];h&&(i[o]=h);const d=s(t,i);n.body=d,r.push(this.config.queue.request(this.config.httpMethod||a.POST,this.config.path,n))}else r.push(this.config.queue.delete(`${this.config.path}/${o}`,this.options))}return Promise.all(r)}async update(t,e){this.clearCache(),await(this.config.batchUpdate?this.updateBatch(t,e||{}):this.updateInternal(t,e||{}))}async delete(t){throw Error("Not implemented")}}},16964:(t,e,s)=>{s.d(e,{l:()=>i});var a=s(68909);class i extends a.Mesh{constructor(t=100,e,s,a=1){super(e,s),this.capacity=t,this.numInstances=a,this.topIdx=0,this.indexMap=new Map,this.viewMap=new Map,this.frustumCulled=!1,this.matrixAutoUpdate=!1}allocInstance(t){const e=this.topIdx;return this.topIdx++,this.topIdx>=this.capacity&&this.doubleBufferCapacities(),this.indexMap.set(t,e),this.viewMap.set(e,t),this.geometry.instanceCount=this.topIdx*this.numInstances,e}removeInstance(t){const e=this.indexMap.get(t);if(null!=e){const s=this.topIdx-1;this.moveInstanceData(s,e),this.indexMap.delete(t),this.viewMap.delete(e);const a=this.viewMap.get(s);null!=a&&(this.indexMap.set(a,e),this.viewMap.set(e,a)),this.topIdx--,this.geometry.instanceCount=this.topIdx*this.numInstances}}removeAllInstances(){this.topIdx=0,this.geometry.instanceCount=0,this.indexMap.clear(),this.viewMap.clear()}moveInstanceData(t,e){if(t!==e)for(const s of this.allAttributeNames){const i=this[s];if(i instanceof a.InstancedBufferAttribute){const s=i.itemSize;for(let a=0;a<this.numInstances;a++)for(let r=0;r<s;r++)i.array[s*(this.numInstances*e+a)+r]=i.array[s*(this.numInstances*t+a)+r];i.needsUpdate=!0}}}get allAttributeNames(){const t=[];for(const e in this)this[e]instanceof a.InstancedBufferAttribute&&t.push(e);return t}*getIndices(t){const e=this.indexMap.get(t);if(null!=e)for(let t=0;t<this.numInstances;t++)yield this.numInstances*e+t}get capacityForAllInstances(){return this.capacity*this.numInstances}doubleBufferCapacities(){this.capacity=2*this.capacity;const t=[];for(const e of this.allAttributeNames){const s=this[e];s instanceof a.InstancedBufferAttribute&&t.push([e,this.expandCapacityForAttr(s)])}this.geometry.dispose();for(const[e,s]of t)this[e]=s,this.geometry.setAttribute(e,s)}expandCapacityForAttr(t){const e=t.array instanceof Uint8Array,s=!!e,i=new(e?Uint8Array:Float32Array)(this.capacity*t.itemSize*this.numInstances);return i.set(t.array),new a.InstancedBufferAttribute(i,t.itemSize,s)}}},35568:(t,e,s)=>{s.d(e,{o:()=>o,A:()=>d});var a=s(68909),i=s(12767),r=s(36476);class n extends a.Object3D{constructor(t){super(),this.anchor=this,this.reset=()=>{this.camera.position.set(0,0,0),this.camera.layers.mask=r.H.ALL.mask,this.camera.updateMatrixWorld(!0)},this.update=t=>{this.anchor.position.copy(t.position),this.camera.quaternion.copy(t.rotation),this.camera.projectionMatrix.copy(t.projection.asThreeMatrix4()),this.camera.projectionMatrixInverse.copy(t.projection.asThreeMatrix4()),this.camera.projectionMatrixInverse.invert(),this.updateMatrixWorld(!0)},this.camera=new a.PerspectiveCamera(i.Bv.fov,t,i.Bv.near,i.Bv.far),this.add(this.camera),this.name="CameraRig",this.reset()}dispose(){this.remove(this.camera)}}var o,c=s(68986),h=s(54387);!function(t){t[t.Root=0]="Root",t[t.CameraRig=1]="CameraRig"}(o||(o={}));class d{get lastRenderCallTime(){return this._lastRenderCallTime}constructor(t,e,s,i,r){this.scene=t,this.threeRenderer=e,this.cameraData=s,this.viewportManager=i,this.engine=r,this.ids=o,this.frameCount=0,this.effectComposer=null,this.rendering=!1,this.cameraRigStale=!0,this.canvasSizeChanged=!0,this.updateComposer=(()=>{const t=new a.Vector2;return()=>{this.canvasSizeChanged&&this.effectComposer&&(this.effectComposer.setPixelRatio(this.effectComposer.renderer.getPixelRatio()),this.effectComposer.renderer.getSize(t),this.effectComposer.setSize(t.x,t.y),this.canvasSizeChanged=!1)}})(),this.renderViewports=(()=>{const t=new a.Vector2;return e=>{var s,a;this.threeRenderer.clear();const i=this.cameraRig.camera.layers.mask;for(const i of this.viewportManager.viewports)if(this.viewportManager.renderingViewport=i,this.viewportManager.commit(),i.rect.getSize(t),this.threeRenderer.setViewport(i.rect.min.x,i.rect.min.y,t.x,t.y),null===(a=(s=this.engine).triggerRenderViewport)||void 0===a||a.call(s,e),this.effectComposer){const t=this.effectComposer.passes[0];t.scene=i.scene||this.scene,t.camera=i.camera,this.effectComposer.render(e)}else this.threeRenderer.render(i.scene||this.scene,i.camera);this.cameraRig.camera.layers.mask=i,this.viewportManager.renderingViewport=null,this.viewportManager.commit()}})(),this.cameraRig=new n(s.aspect()),i.setDomElement(e.domElement),this.viewportManager.defaultViewport.scene=this.scene,this.viewportManager.defaultViewport.camera=this.cameraRig.camera,e.info.autoReset=!1}add(...t){for(const e of t)this.addChild(o.Root,e)}remove(...t){for(const e of t)this.removeChild(o.Root,e)}addChild(t,e){switch(t){case o.Root:this.scene.add(e);break;case o.CameraRig:this.cameraRig.add(e);break;default:return!1}return!0}removeChild(t,e){switch(t){case o.Root:this.scene.remove(e);break;case o.CameraRig:this.cameraRig.remove(e);break;default:return!1}return!0}getSubTree(t){return(0,h.W9)(this.scene,t)}get camera(){return this.updateCameraRig(),this.cameraRig.camera}init(){this.cameraRigStale=!0}dispose(){this.cameraRig.dispose()}startRender(t){this.rendering=t}activate(t){this.scene.add(this.cameraRig),this.cameraDataCallback=()=>this.cameraRigStale=!0,this.cameraData.onChanged(this.cameraDataCallback),this.canvasSizeSub=new c.P(this.cameraData.onPropertyChanged("width",(()=>this.onCanvasSizeChanged())),this.cameraData.onPropertyChanged("height",(()=>this.onCanvasSizeChanged())))}deactivate(t){var e;this.scene.remove(this.cameraRig),this.cameraData.pose.removeOnChanged(this.cameraDataCallback),null===(e=this.canvasSizeSub)||void 0===e||e.cancel()}beforeRender(){this.updateCameraRig(),this.updateComposer()}setCameraDirty(){this.cameraRigStale=!0,this.cameraRig.camera.updateProjectionMatrix()}onCanvasSizeChanged(){this.viewportManager.updateDefaultViewport(),this.canvasSizeChanged=!0}updateCameraRig(){this.cameraRigStale&&(this.cameraRig.update(this.cameraData.pose),this.cameraRigStale=!1)}render(t){var e,s;if(this.rendering)this.threeRenderer.info.reset(),this.renderViewports(t),this.frameCount++;else{for(const a of this.viewportManager.viewports)this.viewportManager.renderingViewport=a,this.viewportManager.commit(),null===(s=(e=this.engine).triggerRenderViewport)||void 0===s||s.call(e,t);this.viewportManager.renderingViewport=null,this.viewportManager.commit()}this._lastRenderCallTime=Date.now()}}},20431:(t,e,s)=>{s.d(e,{lk:()=>r,zM:()=>i});const a=new(s(10843).Ay)("util-browser"),i=function(t,e){if(!("localStorage"in window))return e;let s;try{s=window.localStorage.getItem(t)}catch(t){return a.debug(t),e}return null===s?e:"boolean"==typeof e?"true"===s:"number"==typeof e?parseFloat(s):s},r=function(t,e){try{window.localStorage.setItem(t,e)}catch(t){a.error(t)}}}}]);