/*! For license information please see compare.b85794148a4df29d95e1.js.LICENSE.txt */
"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[8044],{15494:(e,t,a)=>{a.r(t),a.d(t,{default:()=>bt});var o,i,r=a(65945),n=a(68909),s=a(75578),l=a(90082),c=a(71687),d=a(13893),u=a(52026),h=a(12069),m=a(76894),p=a(2993),w=a(15930),v=a(84710),g=a(12554);!function(e){e[e.SINGLE_VIEW=0]="SINGLE_VIEW",e[e.SPLIT_VIEW=1]="SPLIT_VIEW"}(o||(o={})),function(e){e[e.LOCKED=0]="LOCKED",e[e.UNLOCKED=1]="UNLOCKED"}(i||(i={}));class f extends v.B{constructor(){super(...arguments),this.name="compare-view-data",this.viewMode=o.SPLIT_VIEW,this.cameraMode=i.LOCKED,this.activeViews=new g.X,this.availableViews=[]}}var y=a(74771),b=a(74848),M=a(11180),x=a(88581),j=a(96540),O=a(21728),S=a(68375),V=a(90087),N=a(51493),E=a(32485),C=a.n(E),I=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(a[o[i]]=e[o[i]])}return a};const D=(0,j.forwardRef)(((e,t)=>{var{children:a,className:o}=e,i=I(e,["children","className"]);const r=C()("dropdown-menu-content",o);return(0,b.jsx)(N.dc,{children:(0,b.jsx)(N.UC,Object.assign({className:r},i,{ref:t,children:a}))})})),R=((0,j.forwardRef)(((e,t)=>{var{children:a,className:o}=e,i=I(e,["children","className"]);const r=C()("dropdown-menu-sub-content",o);return(0,b.jsx)(N.dc,{children:(0,b.jsx)(N.G5,Object.assign({className:r},i,{ref:t,children:a}))})})),(0,j.forwardRef)(((e,t)=>{var{children:a,className:o}=e,i=I(e,["children","className"]);const r=C()("dropdown-menu-item",o);return(0,b.jsx)(N.q7,Object.assign({className:r,ref:t},i,{children:a}))})),(0,j.forwardRef)(((e,t)=>{var{children:a,className:o}=e,i=I(e,["children","className"]);const r=C()("dropdown-menu-checkbox-item",o);return(0,b.jsxs)(N.H_,Object.assign({className:r,ref:t},i,{children:[(0,b.jsx)(N.VF,{className:"dropdown-menu-checkbox-item-indicator",children:(0,b.jsx)("svg",{width:"10",height:"11",viewBox:"0 0 10 11",children:(0,b.jsx)("circle",{cx:"5",cy:"5.5",r:"2",fill:"currentColor"})})}),a]}))})),(0,j.forwardRef)(((e,t)=>{var{children:a,className:o}=e,i=I(e,["children","className"]);const r=C()("dropdown-menu-radio-group",o);return(0,b.jsx)(N.z6,Object.assign({className:r,ref:t},i,{children:a}))}))),T=(0,j.forwardRef)(((e,t)=>{var{children:a,className:o}=e,i=I(e,["children","className"]);const r=C()("dropdown-menu-radio-item",o);return(0,b.jsxs)(N.hN,Object.assign({className:r,ref:t},i,{children:[(0,b.jsx)(N.VF,{className:"dropdown-menu-radio-item-indicator",children:(0,b.jsx)("svg",{width:"10",height:"11",viewBox:"0 0 10 11",children:(0,b.jsx)("circle",{cx:"5",cy:"5.5",r:"2",fill:"currentColor"})})}),a]}))}));(0,j.forwardRef)(((e,t)=>{var{children:a,className:o}=e,i=I(e,["children","className"]);const r=C()("dropdown-menu-sub-trigger",o);return(0,b.jsx)(N.ZP,Object.assign({className:r,ref:t},i,{children:a}))})),(0,j.forwardRef)(((e,t)=>{var{className:a}=e,o=I(e,["className"]);const i=C()("dropdown-menu-separator",a);return(0,b.jsx)(N.wv,Object.assign({className:i,ref:t},o))}));var k=a(57726),L=a.n(k),P=a(93137),_=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(a[o[i]]=e[o[i]])}return a};function A({onValueChange:e,items:t,Render:a,value:o,ariaLabel:i,className:r,Selected:n,Prompt:s,matchPopupWidthToTrigger:l=!1,selectedIsTrigger:c=!0,RadioItem:d=T}){var u;const[h,m]=(0,j.useState)(!1),p=(0,j.useMemo)((()=>{if(!o)return s?(0,b.jsx)(s,{}):null;const{key:e}=o,t=_(o,["key"]);return n?(0,b.jsx)(n,Object.assign({},t)):(0,b.jsx)(a,Object.assign({},t))}),[n,s,a,o]),w=L()("aura-select-menu-content",{"aura-select-menu-content-match-width":l});return(0,b.jsx)("div",{className:"aura-select",children:(0,b.jsxs)(b.Fragment,{children:[!c&&p,(0,b.jsxs)(N.bL,{open:h,onOpenChange:m,children:[(0,b.jsx)(N.l9,{asChild:!0,children:(0,b.jsxs)("div",{"aria-label":i,className:L()("aura-select-trigger",r),children:[c&&p,(0,b.jsx)(P.I,{name:"dpad-down"})]})}),(0,b.jsx)(D,{className:w,side:"top",align:c?"start":"end",children:(0,b.jsx)(R,{value:null===(u=null==o?void 0:o.key)||void 0===u?void 0:u.toString(),children:t.map((t=>{const{key:o}=t,i=_(t,["key"]);return(0,b.jsx)(d,{onSelect:()=>e(t),value:t.key.toString(),children:(0,b.jsx)(a,Object.assign({},i))},t.key)}))})})]})]})})}var F=a(9241),B=a(56147),U=a(39869),z=a(46793),K=a(10843),G=a(94609);const W={key:p.N3.Dollhouse,value:{analytics:O.r.Dollhouse,icon:"dollhouse",phraseKey:B.A.COMPARE.VIEW_MODE.VIEW_DOLLHOUSE}},Y=[{key:p.N3.Panorama,value:{analytics:O.r.Inside,icon:"panorama",phraseKey:B.A.COMPARE.VIEW_MODE.VIEW_INSIDE}},W,{key:p.N3.Floorplan,value:{analytics:O.r.Floorplan,icon:"floorplan",phraseKey:B.A.COMPARE.VIEW_MODE.VIEW_FLOORPLAN}}],H=new Map(Y.map((e=>[e.key,e])));function Q(){const e=(0,M.x)(),t=function(){const e=(0,x.o)(),t=(0,G.I)(),[a,o]=(0,j.useState)(null);return(0,j.useEffect)((()=>{if(!e)return()=>{};const a=e=>{e!==p.N3.Transition&&(e===p.N3.Dollhouse&&t<.5?o(p.N3.Floorplan):o(e))},i=e.currentModeObservable.onChanged(a);return a(e.currentMode),()=>i.cancel()}),[e,t]),a}(),a=t&&H.get(t)||W,o=e===p.N3.Transition,i=(0,S.s)(),r=(0,V.L)(),n=(0,j.useCallback)((async e=>{if(!o){i.trackGuiEvent(e.value.analytics);try{await r.issueCommand(new z.S2((0,z.gB)(e.key)))}catch(e){K.Ay.for(this).warn(e)}}}),[i,r,o]);return(0,b.jsx)(A,{value:a,onValueChange:n,items:Y,Render:Z,className:"view-mode-select"})}function Z({value:e}){const{icon:t,phraseKey:a}=e,o=(0,U.Y)().t(a);return(0,b.jsxs)("div",{className:"view-mode-label",children:[(0,b.jsx)(P.I,{name:t,size:F.l.MEDIUM}),(0,b.jsx)("span",{children:o})]})}var $=a(17605),X=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(a[o[i]]=e[o[i]])}return a};function q(e){let{tooltipOptions:t}=e,a=X(e,["tooltipOptions"]);return t||(t={}),t.arrow=!1,(0,b.jsx)($.$,Object.assign({className:"aura-primary-button",iconSize:F.l.SMALL,appendChildren:!1,tooltipOptions:t},a,{children:(0,b.jsx)("div",{className:"aura-primary-button-drop-shadow"})}))}function J(){return(0,b.jsx)("span",{className:"gizmo-divider"})}var ee=a(98236),te=a(87805),ae=a(19592);const oe=()=>(0,ee.Bt)(f);var ie=a(17084);function re(e){return ne(e,(0,j.useCallback)((e=>{var t;return null!==(t=null==e?void 0:e.values)&&void 0!==t?t:[]}),[]))}function ne(e,t){const[a,o]=(0,j.useState)(t(e));return(0,j.useEffect)((()=>{if(e){const a=()=>{o(t(e))},i=e.onChanged(a);return a(),()=>i.cancel()}return()=>{}}),[e,t]),a}var se=a(48411),le=a(76853),ce=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(a[o[i]]=e[o[i]])}return a};const de=new K.Ay("ToolSelect");function ue({tools:e}){const t=(0,S.s)(),a=(0,V.L)(),o=(0,se.T)(),i=(0,le.v)(),[r,n]=(0,j.useState)(o||e[0]);null!==o&&o!==r&&-1!==e.indexOf(o)&&n(o);const s=(0,j.useCallback)((t=>t?e.filter((e=>t.has(e))).map((e=>({key:e,value:t.get(e)}))):[]),[e]),l=ne(i.toolsMap,s),c=(0,j.useMemo)((()=>r?{key:r,value:i.getTool(r)}:null),[r,i]),d=(0,j.useCallback)((async e=>{t.trackGuiEvent(e.value.analytic);try{await a.issueCommand(new ie.yU(e.value.id,!0))}catch(e){de.warn(e)}}),[t,a]);return(0,b.jsx)(A,{value:c,onValueChange:d,items:l,Render:me,className:"tool-select",Selected:pe,selectedIsTrigger:!1})}function he(e){const{tool:t,active:a,onClick:o,className:i}=e,r=ce(e,["tool","active","onClick","className"]),n=(0,U.Y)().t(t.namePhraseKey),s=(0,j.useMemo)((()=>t.icon.replace("icon-","")),[t]),l=C()("tool-label",a?"tool-label-selected":null,i);return(0,b.jsxs)("div",Object.assign({className:l,onClick:o},r,{children:[(0,b.jsx)(P.I,{name:s,size:F.l.MEDIUM}),(0,b.jsx)("span",{children:n})]}))}function me({value:e}){return(0,b.jsx)(he,{tool:e})}function pe({value:e}){const t=(0,S.s)(),a=(0,se.T)(),o=(0,V.L)(),i=e.id===a,r=(0,j.useCallback)((a=>{t.trackGuiEvent(e.analytic),o.issueCommand(new ie.yU(e.id,!i)).catch((e=>{de.warn(e)})),a.stopPropagation()}),[e,i,t,o]);return(0,b.jsx)(he,{tool:e,active:i,onClick:r,className:"tool-trigger"})}var we=a(73566),ve=a(23272),ge=a(17904),fe=a(47613),ye=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(a[o[i]]=e[o[i]])}return a};function be({onValueChange:e,items:t,Render:a,RenderGroupHeader:o,ariaLabel:i,className:r,Prompt:n,selectedIsTrigger:s=!0}){const[l,c]=(0,j.useState)(!1),d=(0,j.useMemo)((()=>n?(0,b.jsx)(n,{}):null),[n]);return(0,b.jsx)("div",{className:"aura-select",children:(0,b.jsxs)(b.Fragment,{children:[!s&&d,(0,b.jsxs)(N.bL,{open:l,onOpenChange:c,children:[(0,b.jsx)(N.l9,{asChild:!0,children:(0,b.jsxs)("div",{"aria-label":i,className:L()("aura-select-trigger",r),children:[s&&d,(0,b.jsx)(P.I,{name:"dpad-down"})]})}),(0,b.jsx)(D,{className:"aura-select-menu-content",side:"top",align:s?"start":"end",children:Array.from(t.entries()).map((([t,i])=>{const{key:r}=t,n=ye(t,["key"]);return(0,b.jsxs)("div",{children:[(0,b.jsx)(o,Object.assign({},n)),(0,b.jsx)(R,{value:t.selected,children:i.map((t=>{const{key:o}=t,i=ye(t,["key"]);return(0,b.jsx)(T,{onSelect:()=>e(t),value:t.key.toString(),children:(0,b.jsx)(a,Object.assign({},i))},o)}))})]},r)}))})]})]})})}var Me=a(39188);var xe=a(93900);function je(){const e=(0,V.L)(),t=(0,S.s)(),a=(0,j.useCallback)((async a=>{t.trackGuiEvent("click_floor_select_button");const o=new ve.i1(a.value.id,void 0,void 0,void 0,a.value.viewportId);await e.issueCommand(o)}),[t,e]),o=function(){const e=function(){const e=(0,ge.S)(c.Qm);return e?e.viewportManager.viewports.values:[]}(),t=(0,ge.S)(c.QW),a=re(null==t?void 0:t.currentFloors),o=(0,fe._)(),i=function(){const e=(0,Me.m)();return(0,M.x)()!==p.N3.Panorama&&e}(),r=(0,U.Y)(),n=(0,xe.Y)(),s=new Map;if(!t||!o)return null;const l=o.getCurrentView();for(const o of e){const e=t.getViewDataForViewport(o.id).sourceViewId,c=a.find((t=>t&&t.sourceViewId===e)),d=l.connections.find((t=>t.model.id===e)),u={header:d?d.model.name:e,key:e,selected:(null==c?void 0:c.id)||"all"},h=n.filter((t=>t.sourceViewId===e)).map((e=>({key:e.id,value:Object.assign(Object.assign({},e),{viewportId:o.id})})));i&&h.unshift({key:"all",value:{id:"",index:-1,name:r.t(B.A.FLOOR_ALL),sourceViewId:e,viewportId:o.id}}),s.set(u,h)}return s}();return o?(0,b.jsx)(be,{Render:Se,RenderGroupHeader:Oe,items:o,onValueChange:a,Prompt:Ve}):null}function Oe({header:e}){return(0,b.jsx)("div",{className:"floor-model-header",children:e})}function Se({value:e}){return(0,b.jsx)("div",{className:"floor-label",children:(0,b.jsx)("span",{children:e.name})})}function Ve(){const e=(0,U.Y)().t(B.A.COMPARE.FLOORS.FLOOR_SELECT);return(0,b.jsxs)("div",{className:"floor-label",children:[(0,b.jsx)(P.I,{name:"floor-controls-all",size:F.l.MEDIUM}),(0,b.jsx)("span",{children:e})]})}const Ne=[we.S0.MEASUREMENTS,we.S0.NOTES];function Ee(){const e=oe(),t=(0,te.Z)(f,"cameraMode",i.UNLOCKED),a=(0,j.useCallback)((()=>{e&&(e.cameraMode=i.LOCKED,e.commit())}),[e]),o=(0,j.useCallback)((()=>{e&&(e.cameraMode=i.UNLOCKED,e.commit())}),[e]);return(0,b.jsxs)("div",{className:"tool-bar",children:[t===i.LOCKED&&(0,b.jsx)(q,{label:"Unlink Models",onClick:o}),t===i.UNLOCKED&&(0,b.jsx)(q,{label:"Link Models",onClick:a}),(0,b.jsx)(J,{}),(0,b.jsx)(Q,{}),(0,b.jsx)(je,{}),(0,b.jsx)(ue,{tools:Ne})]})}var Ce=a(30576),Ie=a(60656),De=a(17520),Re=a(59760);function Te(){const e=(0,Re.O)(),t=(0,Ie.EG)(),a=(0,le.v)(),o=re(a.toolsMap),i=(0,j.useMemo)((()=>o.map((e=>{const a=e.ui.renderPersistent;return a&&(0,b.jsx)(a,Object.assign({},t),e.id)})).filter((e=>!!e))),[o,t]),r=e?a.getToolUi(e.id):[];return(0,b.jsxs)(b.Fragment,{children:[...i,(0,b.jsx)(b.Fragment,{children:r.map(((a,o)=>{const i=a;return(0,b.jsx)(i,Object.assign({},t),`${null==e?void 0:e.id}_ui_${o}`)}))})]})}var ke=a(6336),Le=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(e,o[i])&&(a[o[i]]=e[o[i]])}return a};const Pe=L().bind({"model-select":"model-select-b39809e46b1dfe9d3813","model-entry":"model-entry-b5a8340f5d795eb151d8","model-item":"model-item-b6e97804587426de73c7","model-thumbnail":"model-thumbnail-de8d99454e3c29fb4811","model-name":"model-name-da429901fdddf99b989e","model-trigger":"model-trigger-e53ff27a68de983e2c5c","model-entry-disabled":"model-entry-disabled-d71e0f52f4477d7e130f"}),_e=({models:e,value:t,onSelect:a,className:o})=>{const i=Pe("model-select",o),r=(0,j.useMemo)((()=>e.map((e=>({key:e.id,value:e,disabled:e.disabled})))),[e]),n=(0,j.useMemo)((()=>{var e;return null!==(e=r.find((e=>e.key===(null==t?void 0:t.id))))&&void 0!==e?e:null}),[r,null==t?void 0:t.id]),s=(0,j.useCallback)((e=>{a(e.value)}),[a]);return(0,b.jsx)(A,{className:i,Render:Ae,items:r,value:n,onValueChange:s,RadioItem:Be,matchPopupWidthToTrigger:!0,Selected:Fe})},Ae=({value:e})=>{const{id:t,imageUrl:a,name:o,disabled:i}=e,[r]=(0,ke.i)(a),n=Pe("model-entry",{"model-entry-disabled":i});return(0,b.jsxs)("div",{className:n,children:[(0,b.jsx)("img",{className:Pe("model-thumbnail"),src:r}),(0,b.jsx)("div",{className:Pe("model-name"),children:o})]},t)},Fe=({value:e})=>{const{id:t,name:a}=e,o=Pe("model-trigger");return(0,b.jsxs)("div",{className:o,children:[a," "]},t)},Be=(0,j.forwardRef)(((e,t)=>{var a=Le(e,[]);const o=Pe("model-item");return(0,b.jsx)(N.hN,Object.assign({ref:t},a,{className:o}))}));function Ue({viewIndex:e}){const t=oe(),a=(0,te.Z)(f,"availableViews",[]),o=(()=>{const e=oe();return(0,ae.W)(e.activeViews)})(),i=(0,j.useMemo)((()=>a.find((t=>t.id===o[e]))),[a,e,o]);return a.length<=2?null:(0,b.jsx)(_e,{models:a,onSelect:a=>{t&&t.activeViews.update(e,a.id)},value:i,className:"compare-view-selector"})}var ze=a(41616);const Ke=e=>{const t=(0,ze.J)(),a=null==t?void 0:t.iconWhite,o=(0,b.jsx)("img",{src:a,className:"compare-logo",alt:"Matterport logo."});return(0,b.jsx)("div",{className:"compare-logo-menu-button",children:o})},Ge=(0,j.forwardRef)(((e,t)=>{var a;const o=C()("aura-secondary-button",e.className);return(0,b.jsx)($.$,Object.assign({iconSize:null!==(a=e.iconSize)&&void 0!==a?a:F.l.SMALL,tooltipOptions:{arrow:!1}},e,{className:o}))}));var We=a(27975),Ye=a(56023),He=a(55159);function Qe(){const{setLeftPanelContainer:e}=(0,Ie.OB)(),t=(0,Ye.D)(ie.yU,[we.S0.SEARCH,!0]),a=(0,Ye.D)(ie.Te),o=(0,Re.O)(),i=(0,He.U)(),r=(0,j.useCallback)((()=>{o?a():t()}),[o,a,t]);return(0,b.jsxs)("div",{className:"compare-search-panel","data-active-tool":null==o?void 0:o.id,children:[(0,b.jsx)("div",{className:"compare-panel-section",children:(0,b.jsxs)("div",{className:"compare-panel-section-content",children:[(0,b.jsxs)("div",{className:"compare-top-panel",children:[(0,b.jsx)(Ke,{}),(0,b.jsx)(Ge,{icon:"dock",iconSize:F.l.LARGE,onClick:r})]}),(0,b.jsx)(We.k,{className:"compare-panel-model-name",text:i,autocomplete:"off",onInput:()=>{},maxLength:128,readonly:!0})]})}),(0,b.jsx)("div",{className:C()("compare-panel-section","compare-left-panel-portal"),ref:e})]})}function Ze(){return(0,b.jsx)(Ce.y,{theme:Ce.cD.AURA,children:(0,b.jsx)(Ie.s6,{children:(0,b.jsx)("div",{className:"compare-ui",children:(0,b.jsx)($e,{})})})})}function $e(){const{setViewOverlayContainer:e}=(0,Ie.OB)();return(0,b.jsxs)("div",{className:"compare-main-layout",children:[(0,b.jsx)(De.Q,{}),(0,b.jsx)(Xe,{}),(0,b.jsx)("div",{className:"compare-left-panel",children:(0,b.jsx)(Qe,{})}),(0,b.jsxs)("div",{className:"compare-center-panel",children:[(0,b.jsx)("div",{className:"compare-view-tool-overlay",id:Ie.Cz.VIEW_OVERLAY_PORTAL,ref:e}),(0,b.jsx)(Ee,{})]}),(0,b.jsx)(Te,{})]})}function Xe(){return(0,b.jsxs)("div",{className:"compare-viewport-layout-container",children:[(0,b.jsx)("div",{className:"compare-viewport",children:(0,b.jsx)(Ue,{viewIndex:0})}),(0,b.jsx)("div",{className:"compare-viewport",children:(0,b.jsx)(Ue,{viewIndex:1})})]})}var qe,Je=a(78849),et=a(77570),tt=a(22e3),at=a(5338),ot=a(71877),it=a(58480),rt=a(23864),nt=a(74381),st=a(56208),lt=a(74803),ct=a(52721),dt=a(27285),ut=a(99104),ht=a(95330);!function(e){e.GRID_COLOR="grid-color",e.PRIMARY_TEXT="primary-text",e.PRIMARY_BUTTON_SELECTED="primary-button-selected",e.PRIMARY_CONTAINER_EDGE="primary-container-edge",e.PRIMARY_CONTAINER_SURFACE_DARK_STOP="primary-container-surface-dark-stop",e.PRIMARY_CONTAINER_SURFACE_LIGHT_STOP="primary-container-surface-med-stop",e.PRIMARY_CONTAINER_SURFACE_MED_STOP="primary-container-surface-light-stop",e.SKYBOX_SURFACE="skybox-surface",e.SELECTION_OUTLINE_VISIBLE_EDGE_COLOR="selection-outline-visible-edge-color",e.SELECTION_OUTLINE_HIDDEN_EDGE_COLOR="selection-outline-hidden-edge-color",e.SELECTION_OUTLINE_EDGE_GLOW="selection-outline-edge-glow",e.TRANSFORM_GIZMO_BUTTON_COLOR="transform-gizmo-button-color",e.TRANSFORM_GIZMO_BUTTON_TEXT_COLOR="transform-gizmo-button-text-color"}(qe||(qe={}));const mt="gizmo-data-theme";class pt{constructor(e){var t,a,o;const i=null!==(o=null!==(a=null!==(t=this.getThemeFromParams())&&void 0!==t?t:this.getThemeFromLocalStorage())&&void 0!==a?a:this.getThemeFromBrowserPreference())&&void 0!==o?o:e;this.theme=new ht.L(i),this.theme.onChanged((e=>{this.applyThemeToDocument(e),this.saveThemeToLocalStorage(e)})),this.applyThemeToDocument(i)}getThemeFromParams(){const e=new URLSearchParams(window.location.search).get("theme");return"dark"===e||"light"===e?e:void 0}getThemeFromLocalStorage(){const e=window.localStorage.getItem(mt);return"dark"===e||"light"===e?e:void 0}saveThemeToLocalStorage(e){window.localStorage.setItem(mt,e)}getThemeFromBrowserPreference(){if(window.matchMedia("(prefers-color-scheme: dark)").matches)return"dark";return window.matchMedia("(prefers-color-scheme: light)").matches?"light":void 0}applyThemeToDocument(e){window.document.documentElement.setAttribute("data-theme",e)}}var wt=function(e,t,a,o){var i,r=arguments.length,n=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(n=(r<3?i(n):r>3?i(t,a,n):i(t,a))||n);return r>3&&n&&Object.defineProperty(t,a,n),n},vt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},gt=function(e,t){return function(a,o){t(a,o,e)}},ft=B.A.TOOLS;let yt=class extends s.n{constructor(e,t,a,r,s,l,u,p){var w,v;super(),this.settingsModule=e,this.layersModule=a,this.rendererModule=r,this.cameraModule=s,this.sweepDataModule=u,this.cameraStartModule=p,this.name="compare",this.viewportToModel=new Map,this.lockViewportBindings=[],this.lastViewportNavSweep=new Map,this.themeManager=new pt("dark"),this.renderingViewportChanged=e=>{var t;const a=this.rendererModule.getScene(),o=this.layersModule.layersData.getCurrentView(),i=null!==(t=null==e?void 0:e.id)&&void 0!==t?t:this.viewportManager.activeViewport.id;for(const e of o.connections){const t=this.viewportToModel.get(i)===e.model.id;a.getSubTree([o.id,"meshes",e.model.id]).visible=t,a.getSubTree([e.model.id]).visible=t}for(const e of this.viewportManager.viewports){const t=e.id===i;e.annotationLayerIds.forEach((e=>{a.getSubTree([e]).visible=t}))}},this.watchLockMode=e=>{e===i.UNLOCKED?this._unlockViewports():this._lockViewports()},this.viewChanged=(e,t)=>{const a=this.viewportManager.viewports.values;this.matchSweepState(a[1-t].id,[a[t].id],d.fl.Instant)},this.resizeViewports=()=>{const{width:e,height:t}=this.canvasData,a=this.viewportManager.viewports.values;2===a.length&&(e>=t?(a[0].updateRect(new n.Box2(new n.Vector2(0,0),new n.Vector2(e/2,t))),a[1].updateRect(new n.Box2(new n.Vector2(e/2,0),new n.Vector2(e,t)))):(a[1].updateRect(new n.Box2(new n.Vector2(0,0),new n.Vector2(e,t/2))),a[0].updateRect(new n.Box2(new n.Vector2(0,t/2),new n.Vector2(e,t)))))},this.applyViewMode=()=>{const e=()=>{const e=new h.L;this.viewportManager.viewports.set(e.id,e)};this.viewportManager.viewports.clear(),e(),this.viewData.viewMode===o.SPLIT_VIEW&&e(),this.resizeViewports(),this.viewportManager.activeViewport=this.viewportManager.viewports.values[0],this.refreshViewportMap(),this.viewportManager.commit()},this.refreshViewportMap=()=>{this.viewportToModel.clear(),this.viewData.activeViews.forEach(((e,t)=>{const a=this.viewportManager.viewports;if(t<a.length){const o=a.keys[t];if(this.viewportToModel.set(o,e),this.floorsViewDataModule){this.floorsViewDataModule.getViewDataForViewport(o).sourceViewId=e}const i=a.get(o),r=this.rendererModule.getScene();i.annotationLayerIds.forEach((e=>r.getSubTree([e]).visible=!1)),i.annotationLayerIds.replace(this.layersModule.layersData.currentLayers().filter((t=>t.sourceViewId===e)).map((e=>e.id)))}}))},this.loadUi=async(e,t,a)=>{if(!this.enabled)return;e.editMode=!1;const o={locale:e.locale};this.viewportHeight=new tt.A(this.containerData),this.viewportHeight.update(),this.reactRoot=(0,at.createRoot)(t),this.engine.market.waitForData(Je.L).then((e=>{e.simpleSearchView=!0,e.commit()})),this.engine.getModuleBySymbol(c.N7).then((e=>{e.adjustCanvas=!1})),this.reactRoot.render((0,j.createElement)(et.B.Provider,{value:e},[(0,j.createElement)(y.U6.Provider,{key:"compare-ui-locale",value:o},[(0,j.createElement)(ot.u,{key:"error-bar"}),(0,j.createElement)(Ze,{key:"compare-ui"})])])),this.initializeTools()},this.unloadUi=async()=>(this.viewportHeight&&this.viewportHeight.dispose(),!!this.reactRoot&&(this.reactRoot.unmount(),await this.engine.market.waitForData(Je.L).then((e=>{e.simpleSearchView=!1,e.commit()})),await this.engine.getModuleBySymbol(c.N7).then((e=>{e.adjustCanvas=!0})),!0)),this.enabled=null!==(v=null===(w=this.settingsModule)||void 0===w?void 0:w.settingsData.tryGetSetting(m.$,!0))&&void 0!==v&&v,this.canvasData=null==t?void 0:t.data,this.viewportManager=null==l?void 0:l.viewportManager}async init(e,t){if(!this.enabled)return;this.engine=t,this.viewData=new f,t.market.register(f,this.viewData),Promise.all([t.getModuleBySymbol(c.SD),t.getModuleBySymbol(c.PM),t.getModuleBySymbol(c.GR),t.getModuleBySymbol(c.Kv),t.getModuleBySymbol(c.QW)]).then((e=>{this.viewmodeModule=e[0],this.meshQuery=e[1],this.modelMeshModule=e[2],this.navigationModule=e[3],this.floorsViewDataModule=e[4],this.refreshViewportMap(),this.setInitialPanos(),this.watchLockMode(this.viewData.cameraMode)})),t.getModuleBySymbol(c.Kv).then((e=>{this.navigationModule=e,this.navigationModule.addNavigationFilter(this.navigationFilter.bind(this))}));const a=this.layersModule.layersData.getCurrentView();if(a.connections&&a.connections.length>1){this.bindings.push(this.canvasData.onChanged(this.resizeViewports),this.viewData.onPropertyChanged("viewMode",this.applyViewMode),this.viewData.activeViews.onChanged(this.refreshViewportMap),this.viewportManager.onPropertyChanged("renderingViewport",this.renderingViewportChanged),this.viewData.onPropertyChanged("cameraMode",this.watchLockMode),this.viewData.activeViews.onElementChanged({onUpdated:this.viewChanged})),this.applyViewMode(),this.viewData.availableViews=a.connections.map((e=>e.model));const e=Array.from(a.connections.values()).slice(0,2).map((e=>e.model.id));this.viewData.activeViews.replace(e),this.viewData.commit()}this.containerData=await t.market.waitForData(it.G)}async setInitialPanos(){var e,t,a;await this.modelMeshModule.firstMeshLoadPromise,this.sweepDataModule.updateSweepFiltering({removed:new Set([null]),added:new Set(this.viewportToModel.values())});const o=this.viewportManager.viewports.values[0],i=this.viewportToModel.get(o.id),r=null!==(e=this.cameraStartModule.data.getStartingPose().pano.uuid)&&void 0!==e?e:null===(t=this.sweepDataModule.data.getFirstSweep(!0,(e=>e.sourceViewId===i)))||void 0===t?void 0:t.id;await this.viewmodeModule.switchToMode(p.N3.Panorama,d.fl.Instant,{sweepID:r},w.Ou,!1,this.cameraModule.getCameraDataForViewport(o.id),this.sweepDataModule.data.getStateForViewport(o.id));const s={distance:0,point:(new n.Vector3).copy(this.cameraModule.getCameraDataForViewport(o.id).pose.position),object:{raycast:(e,t)=>{},renderOrder:0}};for(const e of this.viewportManager.viewports.values.slice(1)){const t=this.viewportToModel.get(e.id),o=(0,u.I9)(this.sweepDataModule.data,!1,s,this.meshQuery,[],[e=>e.sourceViewId===t]);0!==o.length&&this.sweepDataModule.moveToSweep({transitionType:d.fl.Instant,sweepId:null===(a=o[0].sweep)||void 0===a?void 0:a.id,rotation:this.cameraModule.cameraData.pose.rotation,cameraData:this.cameraModule.getCameraDataForViewport(e.id),sweepDataState:this.sweepDataModule.data.getStateForViewport(e.id),viewId:t})}this.rendererModule.startRender(!0)}_lockViewports(){this.lockViewportBindings.push(this.sweepDataModule.data.state.onChanged((()=>{this.matchSweepState(this.viewportManager.activeViewport.id,this.viewportManager.viewports.values.filter((e=>e.id!==this.viewportManager.activeViewport.id)).map((e=>e.id)),d.fl.Interpolate)})),this.cameraModule.cameraData.pose.onChanged((()=>{for(const e of this.viewportManager.viewports)if(e!==this.viewportManager.activeViewport){const t=this.cameraModule.getCameraDataForViewport(e.id);this.viewmodeModule.data.isInside()?t.pose.rotation.copy(this.cameraModule.cameraData.pose.rotation):t.pose.copy(this.cameraModule.cameraData.pose),t.pose.projection.copy(this.cameraModule.cameraData.pose.projection),t.pose.commit()}})))}matchSweepState(e,t,a){var o,i;const r=this.sweepDataModule.data.getStateForViewport(e),s=r.transition.to||r.currentSweep,l=this.cameraModule.getCameraDataForViewport(e);if(!s)return;const c=this.sweepDataModule.data.getSweep(s),d={distance:0,point:(new n.Vector3).copy(c.position),object:{raycast:(e,t)=>{},renderOrder:0}};for(const e of t){const t=this.viewportManager.viewports.get(e),r=this.sweepDataModule.data.getStateForViewport(t.id);if(!t||!r||!r.canTransition())continue;const n=this.viewportToModel.get(t.id),s=!1,c=e=>e.sourceViewId===n,h=null===(i=null===(o=(0,u.I9)(this.sweepDataModule.data,s,d,this.meshQuery,[],[c]).filter((e=>e.sweep&&c(e.sweep)))[0])||void 0===o?void 0:o.sweep)||void 0===i?void 0:i.id,m=this.lastViewportNavSweep.get(t.id);h&&m!==h&&(this.lastViewportNavSweep.set(t.id,h),this.navigationModule.navigateToSweep(h,{rotation:l.pose.rotation,transitionType:a,transitionSpeedMultiplier:1.1},this.cameraModule.getCameraDataForViewport(t.id),this.sweepDataModule.data.getStateForViewport(t.id)).then((()=>{this.lastViewportNavSweep.get(t.id)===h&&this.lastViewportNavSweep.set(t.id,"")})))}}_unlockViewports(){this.lockViewportBindings.forEach((e=>e.cancel())),this.lockViewportBindings.length=0}navigationFilter(e){return!this.viewportManager.activeViewport||e.sourceViewId===this.viewportToModel.get(this.viewportManager.activeViewport.id)}get theme(){return this.themeManager.theme}initializeTools(){const e=[new rt.N({id:we.S0.MEASUREMENTS,searchModeType:nt.jM.MEASUREMENTPATH,namePhraseKey:ft.MEASUREMENTS,panel:!1,icon:"icon-tape-measure",analytic:"measurements",dimmed:!1,enabled:this.settingsModule.tryGetSetting(st.Q$.Measurements,!0),ui:new lt.o,manager:new ct.R(this.engine,this.settingsModule.settingsData)}),new rt.N({id:we.S0.SUMMARY,namePhraseKey:ft.SUMMARY,panel:!0,panelLeft:!0,analytic:"summary",dimmed:!1,enabled:!0,hidesAppBar:!0,ui:new dt.t})];this.engine.commandBinder.issueCommand(new ie.Kw(e)),this.engine.commandBinder.issueCommandWhenBound(new ut.eo)}};yt=wt([(0,r._q)(),gt(0,(0,r.y_)(l.ZF)),gt(1,(0,r.y_)(c.CE)),gt(2,(0,r.y_)(c.az)),gt(3,(0,r.y_)(c.M7)),gt(4,(0,r.y_)(c.jh)),gt(5,(0,r.y_)(c.Qm)),gt(6,(0,r.y_)(c.Wh)),gt(7,(0,r.y_)(c.di)),vt("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object,Object])],yt);const bt=yt},56023:(e,t,a)=>{a.d(t,{D:()=>r});var o=a(90087),i=a(96540);function r(e,t){const a=(0,o.L)();return(0,i.useCallback)(((...o)=>{const i=t?Array.isArray(t)?t:t(...o):[];a.issueCommand(new e(...i))}),[e,t,a])}},12069:(e,t,a)=>{a.d(t,{L:()=>l,g:()=>c});var o=a(56413),i=a(85616),r=a(12027),n=a(81662),s=a(68909);class l extends i.v{constructor(e=new s.Box2){var t;super(),this.id=""+l.nextId++,this.camera=new s.PerspectiveCamera,this.scene=null,this.annotationLayerIds=new r.y,null===(t=this.camera.layers)||void 0===t||t.enableAll(),this.rect=e,this.size=e.getSize(new s.Vector2)}updateRect(e){this.rect=e,this.size=e.getSize(new s.Vector2),this.commit()}}l.nextId=0;class c extends i.v{constructor(e){super(),this.domElement=e,this.defaultViewport=new l,this.viewports=(0,o.y)({[this.defaultViewport.id]:this.defaultViewport}),this.activeViewport=this.defaultViewport,this.renderingViewport=null,this.getPickPosNDC=(()=>{const e=new s.Vector2,t=new s.Vector2;return(a,o,i)=>{if(!this.domElement)throw new Error("ViewportManager: No domElement set");const r=this.domElement.getBoundingClientRect(),n=i?[...this.viewports.values.reverse(),this.defaultViewport]:[this.activeViewport];for(const s of n)if(e.set(a-r.left,r.bottom-o),i&&s!==this.defaultViewport||e.clamp(s.rect.min,s.rect.max),s.rect.containsPoint(e))return e.sub(s.rect.min),s.rect.getSize(t),i&&this.activeViewport!==s&&(this.activeViewport=s,this.commit()),{x:e.x/t.x*2-1,y:e.y/t.y*2-1,viewport:s};throw new Error("No viewport for this position")}})(),this.worldToScreenPosition=(()=>{const e=new s.Matrix4,t=new s.Matrix4;return(a,o,i,r,l,c,d)=>{var u,h;if(void 0===l&&(l=(null===(u=this.activeViewport)||void 0===u?void 0:u.id)||(null===(h=this.defaultViewport)||void 0===h?void 0:h.id)),!this.domElement)throw new Error("ViewportManager: No domElement set");const m=this.viewports.get(l);if(!m)throw new Error("Invalid viewport id passed to worldToScreenPosition");c=c||new s.Vector2,d=d||new s.Vector3,t.compose(a,o,n.B1.UNIT),e.copy(t),e.invert(),d.set(r.x,r.y,r.z).applyMatrix4(e).applyMatrix4(i);const p=m.rect.max.x-m.rect.min.x,w=m.rect.max.y-m.rect.min.y;c.set((d.x+1)*p/2,(1-d.y)*w/2);const v=this.domElement.getBoundingClientRect(),g=v.bottom-(m.rect.min.y+w);return c.y+=g,c.y-=v.top,c.x+=m.rect.min.x,{screenPosition:c,ndcPosition:d}}})(),this.updateDefaultViewport=()=>{if(!this.domElement)throw new Error("ViewportManager: No domElement set");const e=this.domElement.getBoundingClientRect();this.defaultViewport.updateRect(new s.Box2(new s.Vector2(0,0),new s.Vector2(e.width,e.height)))},e&&this.setDomElement(e),this.onPropertyChanged("activeViewport",(()=>{this.viewports.sort(((e,t)=>e===this.activeViewport?1:t===this.activeViewport?-1:0))}))}dispose(){this.resizeObserver.disconnect(),this.viewports.clear()}setDomElement(e){this.domElement=e,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(this.updateDefaultViewport),this.resizeObserver.observe(e),this.updateDefaultViewport()}viewportIdForLayerId(e){if(1===this.viewports.length)return this.viewports.values[0].id;for(const t of this.viewports)if(t.annotationLayerIds.has(e))return t.id;return this.viewports.values[0].id}}},27975:(e,t,a)=>{a.d(t,{k:()=>u});var o=a(74848),i=a(96540),r=a(32485),n=a.n(r),s=a(30576);const l=9,c=13,d=27,u=(0,i.forwardRef)((({text:e,name:t,label:a,type:r="text",readonly:u,autofocus:h,autocomplete:m="on",placeholder:p,className:w,maxLength:v,onInput:g,onBlur:f,onFocus:y,onKeyDown:b,onKeyUp:M,onReturn:x,onCancel:j,onPaste:O},S)=>{const V=(0,i.useRef)(null),[N,E]=(0,i.useState)(e),[C,I]=(0,i.useState)(!!h),[D,R]=(0,i.useState)(!1),T=(0,i.useId)(),k=(0,s.bt)("mp-text-input"),L=t||T;(0,i.useImperativeHandle)(S,(()=>({focus:()=>{var e,t;V.current===document.activeElement&&(null===(e=V.current)||void 0===e||e.blur()),null===(t=V.current)||void 0===t||t.focus()},blur:()=>{var e;null===(e=V.current)||void 0===e||e.blur()},setText:e=>{var t;null===(t=V.current)||void 0===t||t.setRangeText(e)}})),[V]),(0,i.useEffect)((()=>(E(e),R(!1),()=>{})),[e]),(0,i.useEffect)((()=>(V.current&&h&&V.current.focus(),()=>{})),[h,V]),(0,i.useEffect)((()=>(D&&x&&V.current&&V.current.blur(),()=>{})),[D,V,x]);const P=(0,i.useCallback)((e=>{const t=e.target;E(t.value),g(t.value)}),[g,E]),_=(0,i.useCallback)((e=>{const t=e.target.value;D&&x?(R(!1),x(t)):f&&f(t),I(!1)}),[f,x,D]),A=(0,i.useCallback)((e=>{y&&y(e),I(!0)}),[y]),F=(0,i.useCallback)((e=>{e.stopPropagation();const t=e.which||e.keyCode;t===c&&R(!0);const a=[l,c,d];if("keydown"===e.type&&!a.includes(t))return!1;const o=e.target.value;if(v&&o.length>v&&e.preventDefault(),t===d)j&&j();return!1}),[j,v]),B=(0,i.useCallback)((e=>{let t=!1;b&&(t=b(e)),t||F(e)}),[F,b]),U=(0,i.useCallback)((e=>{let t=e.clipboardData.getData("text/plain").trim();v&&(t=t.substring(0,Math.min(v,t.length))),O&&O(t)}),[O,v]),z=n()("mp-text-input",k,w,{focused:C}),K=a&&(C||!(""===N)),G=C?"":p;return(0,o.jsxs)("div",{className:z,children:[K&&(0,o.jsx)("label",{className:"mp-text-input-label",htmlFor:L,children:a}),(0,o.jsx)("input",{ref:V,autoComplete:m,className:"mp-input",name:L,type:r,value:N,placeholder:G,maxLength:v,onInput:P,onBlur:_,onFocus:A,onKeyPress:F,onKeyDown:B,onKeyUp:M,onPaste:U,readOnly:u})]})}))}}]);